var FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.template=_.memoize(function(i){var t,n={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(e){return(t=t||_.template(i,null,n))(e)}}),function(e,i){"undefined"!=typeof module&&module.exports?module.exports=i():"function"==typeof define?define(i):this.fusionBuilderStickyHeader=i()}(0,function(){return function(o,e){var a,i,n,l=document.getElementById("fusion_builder_container"),s=e||0,r=m(o),u=document.getElementById("fusion_builder_main_container"),d={position:"fixed",top:s+"px",left:r.left+"px",width:r.width+"px","border-top":"22px solid #ffffff","z-index":999},c={};function f(){var e,i,t,n=jQuery("#fusion_builder_controls").height();if(a=m(u),e="fixed"===jQuery("#fusion_builder_controls").css("position")?a.height+r.height-n:a.height,jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),g().top>r.top-s-22&&g().top+s+22+r.height<a.top+e){for(t in i=l.left+"px",d.left=i,d.width=jQuery("#fusion_builder_container").outerWidth()+"px",d)o.style[t]=d[t];jQuery(".fusion-builder-update-buttons").stop().animate({bottom:0},100)}else{for(t in c)o.style[t]=c[t];g().top+s+22+r.height<a.top&&jQuery(".fusion-builder-update-buttons").stop().animate({bottom:"-50px"},100)}}function m(e){var i,t,n=e.getBoundingClientRect(),o=g();return t=n.top+o.top,jQuery(e).parents("#fusion_builder_layout").hasClass("closed")&&(t=(i=jQuery(e).parents("#fusion_builder_layout").find(".ui-sortable-handle")[0].getBoundingClientRect()).top+i.height+o.top),{left:n.left+o.left,top:t,width:n.width,height:n.height}}function g(){return{top:window.pageYOffset||document.documentElement.scrollTop,left:window.pageXOffset||document.documentElement.scrollLeft}}["position","top","left","z-index","border-top"].forEach(function(e){c[e]=o.style[e],c.width="100%"}),jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),window.onscroll&&(i=window.onscroll),window.onresize&&(n=window.onresize),window.onscroll=function(e){f(),i&&i(e)},window.onresize=function(e){var i=jQuery("#fusion_builder_container").outerWidth()+"px",t=u.top;r=m(o),void 0!==a&&a.top!==t&&(o.style.position="absolute",r=m(o)),jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),g().top>r.top-s?o.style.width=i:o.style.width=c.width,f(),n&&n(e)}}});FusionPageBuilder=FusionPageBuilder||{};jQuery(document).ready(function(){FusionPageBuilder.Element=Backbone.Model.extend({defaults:{type:"element"}})});FusionPageBuilder=FusionPageBuilder||{};jQuery(document).ready(function(){var t=[],n=[];_.each(fusionAllElements,function(e){var i;void 0===e.hide_from_builder&&(i={title:e.name,label:e.shortcode},void 0===e.generator_only?t.push(i):i.generator_only=!0,n.push(i))}),t.sort(function(e,i){var t=e.title.toLowerCase(),n=i.title.toLowerCase();return t<n?-1:n<t?1:0}),n.sort(function(e,i){var t=e.title.toLowerCase(),n=i.title.toLowerCase();return t<n?-1:n<t?1:0}),FusionPageBuilder.ViewManager=Backbone.Model.extend({defaults:{modules:t,generator_elements:n,elementCount:0,views:{}},getView:function(e){return this.get("views")[e]},getChildViews:function(t){var e=this.get("views"),n={};return _.each(e,function(e,i){t===e.model.attributes.parent&&(n[i]=e)}),n},generateCid:function(){var e=this.get("elementCount")+1;return this.set({elementCount:e}),e},addView:function(e,i){var t=this.get("views");t[e]=i,this.set({views:t})},removeView:function(t){var e=this.get("views"),n={};_.each(e,function(e,i){i!=t&&(n[i]=e)}),this.set({views:n})},removeViews:function(){this.set({views:{}})},countElementsByType:function(i){var e=this.get("views"),t=0;return _.each(e,function(e){e.model.attributes.type===i&&t++}),t}}),window.FusionPageBuilderViewManager=new FusionPageBuilder.ViewManager});FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.Collection=Backbone.Collection.extend({model:FusionPageBuilder.Element}),window.FusionPageBuilderElements=new FusionPageBuilder.Collection});FusionPageBuilder=FusionPageBuilder||{};!function(c){c(document).ready(function(){FusionPageBuilder.ElementView=window.wp.Backbone.View.extend({className:"fusion_module_block fusion_builder_column_element",template:FusionPageBuilder.template(c("#fusion-builder-block-module-template").html()),events:{"click .fusion-builder-settings":"showSettings","click .fusion-builder-clone-module":"cloneElement","click .fusion-builder-remove":"removeElement","click .fusion-builder-save-module-dialog":"saveElementDialog"},initialize:function(){this.elementIsCloning=!1},render:function(){return this.$el.html(this.template(this.model.attributes)),void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-element",this.model.attributes.params.fusion_global,this.model.get("cid")),this},saveElementDialog:function(e){e&&e.preventDefault(),FusionPageBuilderApp.showLibrary(),c("#fusion-builder-layouts-elements-trigger").click(),c("#fusion-builder-layouts-elements .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_element+"</a></div></div>")},saveElement:function(e){var i=this.getElementContent(),t=c("#fusion_builder_main_container"),n=c("#fusion-builder-save-element-input").val(),o=c("#fusion_save_global").is(":checked"),a=c("#fusion-builder-layouts-elements .fusion-page-layouts"),l=c("#fusion-builder-layouts-elements .fusion-page-layouts .fusion-empty-library-message"),s=this.model,r=!1,u=null,d={};e&&e.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<t.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(u=this.model.attributes.params.fusion_global,delete(d=this.model.get("params")).fusion_global,this.model.set("params",d),i=this.getElementContent(),d.fusion_global=u,this.model.set("params",d)),c.each(jQuery("ul.fusion-page-layouts.fusion-layout-elements li"),function(){var e=jQuery(this).find("h4.fusion-page-layout-title").html().split("<div ")[0];if(n.toLowerCase().trim()===e.toLowerCase().trim())return alert(fusionBuilderText.duplicate_element_name_error),!(r=!0)}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==r&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==n?c.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:n,fusion_save_global:o,fusion_layout_content:i,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"elements"},complete:function(e){FusionPageBuilderApp.layoutIsSaving=!1,a.prepend(e.responseText),c(".fusion-save-element-fields").remove(),l.hide(),o&&(s.attributes.params.fusion_global=c(e.responseText).attr("data-layout_id"),c('div.fusion_builder_column_element[data-cid="'+s.get("cid")+'"]').addClass("fusion-global-element"),c('div.fusion_builder_column_element[data-cid="'+s.get("cid")+'"]').attr("fusion-global-layout",c(e.responseText).attr("data-layout_id")),c('div.fusion_builder_column_element[data-cid="'+s.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+s.get("cid")+'"><span>'+fusionBuilderText.global_element+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0,setTimeout(FusionPageBuilderApp.checkGlobalParents,500,s.get("parent")))}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getElementContent:function(){return FusionPageBuilderApp.generateElementShortcode(this.$el,!1)},removeElement:function(e){var i;e&&e.preventDefault(),i=this.model.get("parent"),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-removed")),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,i)},cloneElement:function(e,i){var t;e&&e.preventDefault(),!0!==this.elementIsCloning&&(this.elementIsCloning=!0,(t=c.extend(!0,{},this.model.attributes)).created="manually",t.cid=FusionPageBuilderViewManager.generateCid(),t.targetElement=this.$el,"undefined"!==t.from&&delete t.from,i&&(t.parent=i),FusionPageBuilderApp.collection.add(t),i||(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.elementIsCloning=!1,e&&FusionPageBuilderEvents.trigger("fusion-element-cloned"),t.parent&&setTimeout(FusionPageBuilderApp.checkGlobalParents,500,t.parent))},showSettings:function(e){var i,t={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};e&&e.preventDefault(),i=new FusionPageBuilder.ModalView(t),c("body").append(i.render().el)}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.ElementPreviewView=window.wp.Backbone.View.extend({className:"fusion_module_block_preview ",initialize:function(){jQuery("#"+fusionAllElements[this.model.attributes.element_type].preview_id).length?this.template=FusionPageBuilder.template(jQuery("#"+fusionAllElements[this.model.attributes.element_type].preview_id).html()):this.template=FusionPageBuilder.template(jQuery("#fusion-builder-block-module-default-preview-template").html())},render:function(){return this.$el.html(this.template(this.model.attributes)),this}})});FusionPageBuilder=FusionPageBuilder||{};!function(u){u(document).ready(function(){FusionPageBuilder.ElementLibraryView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(u("#fusion-builder-modules-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element:not(.fusion-builder-element-generator)":"addModule","click .fusion_builder_custom_elements_load":"addCustomModule","click .fusion-builder-column-layouts li":"addNestedColumns"},initialize:function(e){this.options=e,this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.remove)},render:function(){var e=this;return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),FusionPageBuilderApp.showSavedElements("elements",this.$el.find("#custom-elements")),"true"===FusionPageBuilderApp.innerColumn&&this.$el.addClass("fusion-add-to-nested"),setTimeout(function(){e.$el.find(".fusion-elements-filter").focus()},50),this},addCustomModule:function(t){var e,i,n;t&&t.preventDefault(),!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,e=u(t.currentTarget).closest("li").data("layout_id"),i=u(t.currentTarget).find(".fusion_module_title").text(),n=u(t.currentTarget).closest("li").hasClass("fusion-global"),u(t.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),u(t.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),u.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:n,fusion_layout_id:e},success:function(e){var i=JSON.parse(e);FusionPageBuilderApp.shortcodesToBuilder(i.post_content,FusionPageBuilderApp.parentColumnId),FusionPageBuilderApp.layoutIsLoading=!1,u(t.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),u(t.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide(),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,FusionPageBuilderApp.parentColumnId)},complete:function(){fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_custom_element+i,FusionPageBuilderEvents.trigger("fusion-element-added")}}))},addModule:function(e){var i,t,n,o,a,l,s;e&&e.preventDefault(),(i=u(e.currentTarget).find(".fusion_module_label").text())in fusionAllElements?(t=fusionAllElements[i].params,o=fusionAllElements[i].multi,a=fusionAllElements[i].shortcode,l=fusionAllElements[i].name,s=fusionAllElements[i].allow_generator,n=fusionAllElements[i].params,t={},_.each(n,function(e){t[e.param_name]=_.isObject(e.value)?e.default:e.value})):s=a=o=t="",e&&(window.fusionHistoryState=fusionBuilderText.added+" "+l+" "+fusionBuilderText.element),this.collection.add([{type:"element",added:"manually",cid:FusionPageBuilderViewManager.generateCid(),element_type:a,params:t,parent:this.attributes["data-parent_cid"],view:this.options.view,allow_generator:s,multi:o}]),this.remove(),FusionPageBuilderEvents.trigger("fusion-element-added")},addNestedColumns:function(e,i){var n,o,t,a,l,s,r;e&&e.preventDefault(),n=FusionPageBuilderViewManager.generateCid(),this.collection.add([{type:"fusion_builder_row_inner",element_type:"fusion_builder_row_inner",cid:n,parent:this.model.get("cid"),view:this,appendAfter:i}]),FusionPageBuilderApp.activeModal="column",o=this,t=(u(e.target).is("li")?u(e.target):u(e.target).closest("li")).data("layout").split(","),_.size(t),a=this.options.view,l=fusionAllElements.fusion_builder_column_inner.params,s={},_.each(l,function(e){r=_.isObject(e.value)?e.default:e.value,s[e.param_name]=r}),_.each(t,function(e,i){var t={type:"fusion_builder_column_inner",element_type:"fusion_builder_column_inner",cid:FusionPageBuilderViewManager.generateCid(),parent:n,layout:e,view:a,params:s};o.collection.add([t])}),this.remove(),FusionPageBuilderEvents.trigger("fusion-columns-added"),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned"))}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(c){c(document).ready(function(){FusionPageBuilder.GeneratorElementsView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(c("#fusion-builder-generator-modules-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element":"addElement","click .fusion-builder-column-layouts .generator-column":"addColumns","click .fusion-builder-column-layouts .generator-section":"addContainer"},initialize:function(e){this.options=e,this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.remove)},render:function(){var e=this;return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),setTimeout(function(){e.$el.find(".fusion-elements-filter").focus()},50),this},addElement:function(e){var i,t,n,o,a,l,s,r;e&&e.preventDefault(),(i=c(e.currentTarget)).find(".fusion_module_title").text(),a=(t=i.find(".fusion_module_label").text())in fusionAllElements?(o=fusionAllElements[t].multi,fusionAllElements[t].shortcode):o=n="",s=c.extend(!0,{},fusionAllElements[t].params),n={},_.each(s,function(e){var i;i=_.isObject(e.value)?e.default:e.value,n[e.param_name]=i}),r={type:"generated_element",added:"manually",element_type:a,params:n,view:this.options.view,multi:o,cid:FusionPageBuilderViewManager.generateCid()},"undefined"!==n.element_content&&"undefined"!=typeof tinyMCE&&"undefined"!==tinyMCE.activeEditor&&void 0===o&&window.tinyMCE.activeEditor&&(l=window.tinyMCE.activeEditor.selection.getContent())&&(r.params.element_content=l,window.tinyMCE.activeEditor.selection.setContent(""),l="",delete r.added),this.collection.add(r),this.remove()},addColumns:function(e){var n,i,o,t,a,l,s,r="[fusion_builder_row_inner]",u="fusion_builder_column_inner",d="[/fusion_builder_row_inner]";!FusionPageBuilderApp.builderActive&&jQuery(e.target).parents("#builder-regular-columns").length&&(u="fusion_builder_column",d=r=""),e&&e.preventDefault(),FusionPageBuilderApp.activeModal="column",n=this,i=(c(e.target).is("li")?c(e.target):c(e.target).closest("li")).data("layout").split(","),_.size(i),o=this.options.view,t=fusionAllElements[u].params,a={},_.each(t,function(e){l=_.isObject(e.value)?e.default:e.value,a[e.param_name]=l}),_.each(i,function(e,i){var t;a.type=e,t={type:"generated_element",added:"manually",element_type:u,layout:e,view:o,params:a},s=n.collection.add(t),r+=FusionPageBuilderApp.generateElementShortcode(s,!1,!0)}),r+=d,fusionBuilderInsertIntoEditor(r,FusionPageBuilderApp.shortcodeGeneratorEditorID),FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID="",this.remove()},addContainer:function(e){var i,t,n;e&&e.preventDefault(),FusionPageBuilderApp.activeModal="container",FusionPageBuilderViewManager.generateCid(),i=fusionAllElements.fusion_builder_container.params,t={},_.each(i,function(e){n=_.isObject(e.value)?e.default:e.value,t[e.param_name]=n}),this.collection.add([{type:"generated_element",added:"manually",element_type:"fusion_builder_container",params:t,view:this}])}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(c){c(document).ready(function(){FusionPageBuilder.ContainerView=window.wp.Backbone.View.extend({className:"fusion_builder_container",template:FusionPageBuilder.template(c("#fusion-builder-container-template").html()),events:{"click .fusion-builder-clone-container":"cloneContainer","click .fusion-builder-remove":"removeContainer","click .fusion-builder-section-add":"addContainer","click .fusion-builder-toggle":"toggleContainer","click .fusion-builder-settings-container":"showSettings","paste .fusion-builder-section-name":"renameContainer","keydown .fusion-builder-section-name":"renameContainer","click .fusion-builder-save-element":"saveElementDialog"},initialize:function(){this.typingTimer,this.doneTypingInterval=800},render:function(){return this.$el.html(this.template(this.model.toJSON())),void 0!==this.model.attributes.params.admin_toggled&&"yes"===this.model.attributes.params.admin_toggled&&(this.$el.addClass("fusion-builder-section-folded"),this.$el.find("span").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down")),void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-container",this.model.attributes.params.fusion_global,this.model.get("cid")),this.updateStatusIcons(),this},updateStatusIcons:function(){var e=this.$el.find(".fusion-builder-container-utility-toolbar"),i="";e.find(".fusion-builder-publish-tooltip").remove(),"draft"===this.model.attributes.params.status?(i='<div class="fusion-builder-publish-tooltip fusion-container-draft" data-cid="'+this.model.get("cid")+'"><span>'+fusionBuilderText.container_draft+"<br>"+fusionBuilderText.container_publish+"</span></div>",e.prepend(i)):"published_until"!==this.model.attributes.params.status&&"publish_after"!==this.model.attributes.params.status||(i='<div class="fusion-builder-publish-tooltip fusion-container-scheduled" data-cid="'+this.model.get("cid")+'"><span>'+fusionBuilderText.container_scheduled+"<br>"+fusionBuilderText.container_publish+"</span></div>",e.prepend(i))},saveElement:function(e){var i=this.getContainerContent(),t=c("#fusion_builder_main_container"),o=c("#fusion-builder-save-element-input").val(),n=c("#fusion_save_global").is(":checked"),a=c("#fusion-builder-layouts-sections .fusion-page-layouts"),l=c("#fusion-builder-layouts-sections .fusion-empty-library-message"),s=this.model,r=!1,u=null,d={};e&&e.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<t.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(u=this.model.attributes.params.fusion_global,delete(d=this.model.get("params")).fusion_global,this.model.set("params",d),i=this.getContainerContent(),d.fusion_global=u,this.model.set("params",d)),c.each(jQuery("ul.fusion-page-layouts.fusion-layout-sections li"),function(e,i){var t,n=jQuery(this).find("h4.fusion-page-layout-title");if(n.length&&(t=n.html().split("<div ")[0],o.toLowerCase().trim()===t.toLowerCase().trim()))return alert(fusionBuilderText.duplicate_element_name_error),!(r=!0)}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==r&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==o?c.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:o,fusion_save_global:n,fusion_layout_content:i,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"sections"},complete:function(e){FusionPageBuilderApp.layoutIsSaving=!1,a.prepend(e.responseText),c(".fusion-save-element-fields").remove(),l.hide(),n&&(s.attributes.params.fusion_global=c(e.responseText).attr("data-layout_id"),c('div[data-cid="'+s.get("cid")+'"]').closest(".fusion_builder_container").addClass("fusion-global-container"),c('div[data-cid="'+s.get("cid")+'"]').attr("fusion-global-layout",c(e.responseText).attr("data-layout_id")),c('div[data-cid="'+s.get("cid")+'"]').closest(".fusion_builder_container").find(".fusion-builder-container-utility-toolbar").length?c('div[data-cid="'+s.get("cid")+'"]').closest(".fusion_builder_container").find(".fusion-builder-container-utility-toolbar").append('<div class="fusion-builder-global-tooltip" data-cid="'+s.get("cid")+'"><span>'+fusionBuilderText.global_container+"</span></div>"):c('div[data-cid="'+s.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+s.get("cid")+'"><span>'+fusionBuilderText.global_container+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0)}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getContainerContent:function(e,i,t){var n="",o=this.$el.find(".fusion-builder-section-content");return n+=FusionPageBuilderApp.generateElementShortcode(this.$el,!0),o.find(".fusion_builder_row").each(function(){var e=c(this);n+="[fusion_builder_row]",e.find(".fusion-builder-column-outer").each(function(){var e=c(this),i=e.data("cid"),t=FusionPageBuilderViewManager.getView(i);n+=t.getColumnContent(e)}),n+="[/fusion_builder_row]"}),n+="[/fusion_builder_container]"},saveElementDialog:function(e){var i;i=void 0!==this.model.get("admin_label")&&""!==this.model.get("admin_label")?this.model.get("admin_label"):"",e&&e.preventDefault(),FusionPageBuilderApp.showLibrary(),c("#fusion-builder-layouts-sections-trigger").click(),c("#fusion-builder-layouts-sections .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="'+i+'" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_section+"</a></div></div>")},showSettings:function(e){var i,t={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};e&&e.preventDefault(),i=new FusionPageBuilder.ModalView(t),c("body").append(i.render().el),this.hideHundredPercentOption()},hideHundredPercentOption:function(){var e=jQuery("#page_template"),i=jQuery("#pyre_portfolio_width_100").val(),t=jQuery('.fusion_builder_container li[data-option-id="hundred_percent"]');"100-width.php"!==e.val()&&"yes"!==i&&(void 0===i||"no"===i||"default"===i&&""===FusionPageBuilderApp.fullWidth)&&t.hide()},addContainer:function(e){var i,t,n,o;e&&(e.preventDefault(),FusionPageBuilderApp.newContainerAdded=!0),FusionPageBuilderApp.activeModal="container",i=FusionPageBuilderViewManager.generateCid(),t=fusionAllElements.fusion_builder_container.params,n={},_.each(t,function(e){o=_.isObject(e.value)?e.default:e.value,n[e.param_name]=o,"dimension"===e.type&&_.isObject(e.value)&&_.each(e.value,function(e,i){n[i]=e})}),this.collection.add([{type:"fusion_builder_container",added:"manually",element_type:"fusion_builder_container",cid:i,params:n,view:this,created:"auto"}]),FusionPageBuilderApp.activeModal=""},addRow:function(){var e=FusionPageBuilderViewManager.generateCid();this.collection.add([{type:"fusion_builder_row",element_type:"fusion_builder_row",added:"manually",cid:e,parent:this.model.get("cid"),view:this}])},cloneContainer:function(e){var o;e&&e.preventDefault(),(o=c.extend(!0,{},this.model.attributes)).cid=FusionPageBuilderViewManager.generateCid(),o.created="manually",o.view=this,FusionPageBuilderApp.collection.add(o),this.$el.find(".fusion-builder-row-content:not(.fusion_builder_row_inner .fusion-builder-row-content)").each(function(){var e=c(this),i=e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),n=c.extend(!0,{},t.attributes);n.created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),n.parent=o.cid,FusionPageBuilderApp.collection.add(n),e.find(".fusion-builder-column-outer").each(function(){var e=c(this),i=e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),l=c.extend(!0,{},t.attributes);l.created="manually",l.cid=FusionPageBuilderViewManager.generateCid(),l.parent=n.cid,l.from="fusion_builder_container",l.cloned=!0,FusionPageBuilderApp.collection.add(l),e.children(".fusion_module_block, .fusion_builder_row_inner").each(function(){var e,i,t,n,o,a;c(this).hasClass("fusion_module_block")?(e=c(this),i=e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),(n=c.extend(!0,{},t.attributes)).created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),n.parent=l.cid,n.from="fusion_builder_container",FusionPageBuilderApp.collection.add(n)):c(this).hasClass("fusion_builder_row_inner")&&(o=c(this).data("cid"),void 0!==(a=FusionPageBuilderViewManager.getView(o))&&a.cloneNestedRow("",l.cid))})})}),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned_section,FusionPageBuilderEvents.trigger("fusion-element-cloned")},removeContainer:function(e){var i;e&&e.preventDefault(),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){"fusion_builder_row"===e.model.get("type")&&e.removeRow()}),1<FusionPageBuilderViewManager.countElementsByType("fusion_builder_container")||(FusionPageBuilderApp.blankPage=!0),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),!0!==FusionPageBuilderApp.blankPage?e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted_section,FusionPageBuilderEvents.trigger("fusion-element-removed")):FusionPageBuilderApp.clearBuilderLayout(!0)},toggleContainer:function(e){var i=c(e.currentTarget);e&&e.preventDefault(),this.$el.toggleClass("fusion-builder-section-folded"),i.find("span").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down"),this.$el.hasClass("fusion-builder-section-folded")?this.model.attributes.params.admin_toggled="yes":this.model.attributes.params.admin_toggled="no",FusionPageBuilderEvents.trigger("fusion-element-edited")},renameContainer:function(e){var i,t;if(13==(e.keyCode||e.which))return e.preventDefault(),this.$el.find(".fusion-builder-section-name").blur(),!1;i=this.model,t=this.$el.find(".fusion-builder-section-name"),clearTimeout(this.typingTimer),this.typingTimer=setTimeout(function(){i.attributes.params.admin_label=t.val(),FusionPageBuilderEvents.trigger("fusion-element-edited")},this.doneTypingInterval)}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.BlankPageView=window.wp.Backbone.View.extend({className:"fusion_builder_blank_page",template:FusionPageBuilder.template(e("#fusion-builder-blank-page-template").html()),events:{"click .fusion-builder-new-section-add":"addContainer","click .fusion-builder-video-button":"openVideoModal"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el.find("#video-dialog").dialog({dialogClass:"fusion-builder-dialog",autoOpen:!1,modal:!0,height:420,width:590}),this},openVideoModal:function(e){e.preventDefault(),jQuery("#video-dialog").dialog("open"),jQuery("#video-dialog iframe")[0].contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*")},addContainer:function(e){var i,t,n,o;e&&(e.preventDefault(),FusionPageBuilderApp.newContainerAdded=!0),FusionPageBuilderApp.activeModal="container",i=FusionPageBuilderViewManager.generateCid(),t=fusionAllElements.fusion_builder_container.params,n={},_.each(t,function(e){o=_.isObject(e.value)?e.default:e.value,n[e.param_name]=o,"dimension"===e.type&&_.isObject(e.value)&&_.each(e.value,function(e,i){n[i]=e})}),this.collection.add([{type:"fusion_builder_container",added:"manually",element_type:"fusion_builder_container",cid:i,params:n,view:this,created:"auto"}]),this.remove()},removeBlankPageHelper:function(e){e&&e.preventDefault(),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove()}}),jQuery("body").on("click",".ui-dialog-titlebar-close",function(){var e=jQuery(this).closest(".ui-dialog");e.find("#video-dialog").length&&(e.find("#video-dialog iframe")[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),e.hide())})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.RowView=window.wp.Backbone.View.extend({className:"fusion_builder_row",template:FusionPageBuilder.template(a("#fusion-builder-row-template").html()),events:{"click .fusion-builder-insert-column":"displayColumnsOptions"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.sortableColumns(),"manually"!==this.model.get("created")&&this.$el.find(".fusion-builder-insert-column").trigger("click"),this},sortableColumns:function(){var o=this;o.$el.find(".fusion-builder-row-container").sortable({helper:"clone",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-column, .fusion-builder-resize-column, .column-sizes, .fusion-builder-save-column-dialog, .fusion-builder-save-inner-row-dialog-button, .fusion-builder-remove-inner-row, .fusion_builder_row_inner .fusion-builder-row-content",items:".fusion-builder-column-outer",connectWith:".fusion-builder-row-container",tolerance:"pointer",update:function(e,i){var t=i.item.data("cid"),n=o.collection.find(function(e){return e.get("cid")===t});n.get("parent")===o.model.attributes.cid&&a(i.item).closest(e.target).length||n.set("parent",o.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved_column,FusionPageBuilderEvents.trigger("fusion-element-sorted")}}).disableSelection()},displayColumnsOptions:function(e){var i;e&&e.preventDefault(),FusionPageBuilderApp.parentRowId=this.model.get("cid"),i=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"column_library"},view:this}),a("body").append(i.render().el)},removeRow:function(e){var i;e&&e.preventDefault(),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){e.removeColumn()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&FusionPageBuilderEvents.trigger("fusion-element-removed")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(d){d(document).ready(function(){FusionPageBuilder.InnerRowView=window.wp.Backbone.View.extend({className:"fusion_builder_row_inner fusion_builder_column_element",template:FusionPageBuilder.template(d("#fusion-builder-row-inner-template").html()),events:{"click .fusion-builder-remove-inner-row":"removeRow","click .fusion-builder-save-inner-row-dialog-button":"saveElementDialog","click .fusion-builder-clone-inner-row":"cloneNestedRow","click .fusion-builder-inner-row-overlay":"showInnerRowDialog","click .fusion-builder-inner-row-close":"hideInnerRowDialog","click .fusion-builder-inner-row-close-icon":"hideInnerRowDialog","click .fusion-builder-modal-save":"saveInnerRowSettings","click .fusion-builder-insert-inner-column":"displayInnerColumn"},initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.listenTo(FusionPageBuilderEvents,"fusion-close-inner-modal",this.hideInnerRowDialog)},showInnerRowDialog:function(e){var i=this.$el;e&&e.preventDefault(),FusionPageBuilderApp.allContent=fusionBuilderGetContent("content",!0),FusionPageBuilderApp.pauseBuilder=!0,i.find(".fusion-builder-row-content").show(),d("body").addClass("fusion_builder_inner_row_no_scroll").append('<div class="fusion_builder_modal_inner_row_overlay"></div>')},hideInnerRowDialog:function(e){var i=this.$el,t="";e&&e.preventDefault(),FusionPageBuilderApp.pauseBuilder&&(FusionPageBuilderApp.pauseBuilder=!1,FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(FusionPageBuilderApp.allContent)),i.find(".fusion-builder-row-content").hide(),d("body").removeClass("fusion_builder_inner_row_no_scroll"),d(".fusion_builder_modal_inner_row_overlay").remove(),this.$el.find(".fusion-builder-column-inner").each(function(){void 0!==jQuery(this)[0].dataset?t+=jQuery(this)[0].dataset.columnSize.replace("_","/")+" + ":t+=jQuery(this).data("column-size").replace("_","/")+" + "}),this.$el.find("> p").html(t.slice(0,t.length-3))},saveInnerRowSettings:function(){var e,i,t="";FusionPageBuilderApp.pauseBuilder=!1,i=this.$el,(e=FusionPageBuilderElements.find(function(e){return e.get("cid")===i.data("cid")})).set({chnaged:{changed:!0}}),FusionPageBuilderEvents.trigger("fusion-element-edited"),this.$el.find(".fusion-builder-column-inner").each(function(){void 0!==jQuery(this)[0].dataset?t+=jQuery(this)[0].dataset.columnSize.replace("_","/")+" + ":t+=jQuery(this).data("column-size").replace("_","/")+" + "}),this.$el.find("> p").html(t.slice(0,t.length-3)),this.$el.find(".fusion-builder-row-content").hide(),d("body").removeClass("fusion_builder_inner_row_no_scroll"),d(".fusion_builder_modal_inner_row_overlay").remove(),e.set({chnaged:{}}),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.edited_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-edited")},displayInnerColumn:function(e){var i;e&&e.preventDefault(),FusionPageBuilderApp.parentRowId=this.model.get("cid"),i=new FusionPageBuilder.NestedColumnLibraryView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"nested_column_library"},view:this}),d(this.$el).find(".fusion-builder-row-content").append(i.render().el)},render:function(){var e=this.$el,i="";return this.$el.html(this.template(this.model.toJSON())),this.sortableColumns(),setTimeout(function(){e.find(".fusion-builder-column-inner").each(function(){i+=jQuery(this).data("column-size").replace("_","/")+" + "}),e.find("> h4").after("<p>"+i.slice(0,i.length-3)+"</p>")},100),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-element",this.model.attributes.params.fusion_global,this.model.get("cid")),this},cloneNestedRow:function(e,i){var n;e&&e.preventDefault(),(n=d.extend(!0,{},this.model.attributes)).created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),e&&(n.appendAfter=this.$el),i&&(n.parent=i),FusionPageBuilderApp.collection.add(n),this.$el.find(".fusion-builder-column-inner").each(function(){var e=d(this),i=e.data("cid"),t=FusionPageBuilderElements.findWhere({cid:i}),o=d.extend(!0,{},t.attributes);o.created="manually",o.cid=FusionPageBuilderViewManager.generateCid(),o.parent=n.cid,FusionPageBuilderApp.collection.add(o),e.find(".fusion_module_block").each(function(){var e=d(this),i=void 0===e.data("cid")?e.find(".fusion-builder-data-cid").data("cid"):e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),n=d.extend(!0,{},t.attributes);n.created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),n.parent=o.cid,n.from="fusion_builder_row_inner",FusionPageBuilderApp.collection.add(n)})}),i||(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned")),n.parent&&setTimeout(FusionPageBuilderApp.checkGlobalParents,500,n.parent)},saveElementDialog:function(e){e&&e.preventDefault(),FusionPageBuilderApp.showLibrary(),d("#fusion-builder-layouts-elements-trigger").click(),d("#fusion-builder-layouts-elements .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_element+"</a></div></div>")},saveElement:function(e){var i=this.getInnerRowContent(),t=d("#fusion_builder_main_container"),n=d("#fusion-builder-save-element-input").val(),o=d("#fusion_save_global").is(":checked"),a=d("#fusion-builder-layouts-elements .fusion-page-layouts"),l=d("#fusion-builder-layouts-elements .fusion-page-layouts .fusion-empty-library-message"),s=this.model,r=null,u={};e&&e.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<t.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(r=this.model.attributes.params.fusion_global,delete(u=this.model.get("params")).fusion_global,this.model.set("params",u),i=this.getInnerRowContent(),u.fusion_global=r,this.model.set("params",u)),""!==n?d.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:n,fusion_save_global:o,fusion_layout_content:i,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"elements",fusion_layout_element_type:"nested"},complete:function(e){a.prepend(e.responseText),d(".fusion-save-element-fields").remove(),l.hide(),o&&(s.attributes.params={fusion_global:d(e.responseText).attr("data-layout_id")},d('div.fusion_builder_column_element[data-cid="'+s.get("cid")+'"]').addClass("fusion-global-element"),d('div.fusion_builder_column_element[data-cid="'+s.get("cid")+'"]').attr("fusion-global-layout",d(e.responseText).attr("data-layout_id")),d('div.fusion_builder_column_element[data-cid="'+s.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+s.get("cid")+'"><span>'+fusionBuilderText.global_column+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0,setTimeout(FusionPageBuilderApp.checkGlobalParents,500,s.get("parent")))}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name))},getInnerRowContent:function(){var n="",e=this.$el,i=e.data("cid");FusionPageBuilderElements.findWhere({cid:i});return n+="[fusion_builder_row_inner]",e.find(".fusion-builder-column-inner").each(function(){var e=d(this),i=e.data("cid"),t=FusionPageBuilderViewManager.getView(i);n+=t.getColumnContent(e)}),n+="[/fusion_builder_row_inner]"},sortableColumns:function(){var o=this;o.$el.find(".fusion-builder-row-container-inner").sortable({items:".fusion-builder-column-inner",helper:"clone",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-column, .fusion-builder-resize-column, .column-sizes, .fusion-builder-save-column-dialog",tolerance:"pointer",update:function(e,i){var t=i.item.data("cid"),n=o.collection.find(function(e){return e.get("cid")===t});n.get("parent")===o.model.attributes.cid&&d(i.item).closest(e.target).length||n.set("parent",o.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved_nested_column,FusionPageBuilderEvents.trigger("fusion-element-sorted")}}).disableSelection()},removeRow:function(e,i){var t,n;e&&e.preventDefault(),n=this.model.get("parent"),t=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(t,function(e){e.removeColumn()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-removed")),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,n)}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(s){s(document).ready(function(){FusionPageBuilder.NestedColumnView=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(s("#fusion-builder-inner-column-template").html()),events:{"click .fusion-builder-add-element":"addModule","click .fusion-builder-settings-column":"showSettings","click .fusion-builder-resize-inner-column":"columnSizeDialog","click .column-size":"columnSize","click .fusion-builder-remove-inner-column":"removeColumn","click .fusion-builder-clone-inner-column":"cloneColumn"},initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.$el.attr("data-column-size",this.model.get("layout"))},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.sortableElements(),this},sortableElements:function(){var a=this;this.$el.sortable({items:".fusion_module_block",connectWith:".fusion-builder-column-inner",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-add-element, .fusion-builder-insert-column, .fusion-builder-save-module-dialog",tolerance:"pointer",update:function(e,i){var t=s(i.item),n=i.item.data("cid"),o=a.collection.find(function(e){return e.get("cid")===n});s(i.item).closest(e.target).length&&1===s(e.target).find(".fusion_module_block").length&&t.insertBefore(s(e.target).find(".fusion-builder-add-element")),o.get("parent")===a.model.attributes.cid&&s(i.item).closest(e.target).length||o.set("parent",a.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved+" "+fusionAllElements[o.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-sorted")}})},showSettings:function(e){var i,t={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};e&&e.preventDefault(),i=new FusionPageBuilder.ModalView(t),s("body").append(i.render().el)},removeColumn:function(e){var i,t;e&&e.preventDefault(),t=this.model.get("parent"),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){e.removeElement()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&FusionPageBuilderEvents.trigger("fusion-element-removed"),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,t)},cloneColumn:function(e){var o=s.extend(!0,{},this.model.attributes);e&&e.preventDefault(),o.created="manually",o.cid=FusionPageBuilderViewManager.generateCid(),o.targetElement=this.$el,o.cloned=!0,FusionPageBuilderApp.collection.add(o),this.$el.find(".fusion_builder_column_element").each(function(){var e,i,t,n;s(this).hasClass("fusion_module_block")&&(e=s(this),i=void 0===e.data("cid")?e.find(".fusion-builder-data-cid").data("cid"):e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),(n=s.extend(!0,{},t.attributes)).created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),n.parent=o.cid,n.from="fusion_builder_column",FusionPageBuilderApp.collection.add(n))}),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned"))},addModule:function(e){var i,t;e&&(e.preventDefault(),e.stopPropagation()),FusionPageBuilderApp.innerColumn="true",FusionPageBuilderApp.parentColumnId=this.model.get("cid"),((t=s(e.target)).is("span")?t.parent(".fusion-builder-add-element"):t).parent().is(e.delegateTarget)&&(i=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_library"},view:this}),s("body").append(i.render().el))},columnSizeDialog:function(e){var i=this.$el.position().left,t=this.$el.parents(".fusion-builder-row-container-inner").width();e&&e.preventDefault(),t-i<240&&this.$el.find(".column-sizes").css({left:"auto",right:"0"}),this.$el.find(".column-sizes").toggle()},columnSize:function(e){var i=s(e.currentTarget),t=this.model.get("layout"),n=i.attr("data-column-size"),o="";e&&e.preventDefault(),void 0!==n&&(this.model.set("layout",n),this.$el.attr("data-column-size",n),this.$el.removeClass("fusion-builder-column-"+t),this.$el.addClass("fusion-builder-column-"+n),o=n.replace("_","/"),this.$el.find(".fusion-builder-resize-inner-column").text(o),this.$el.find(".column-sizes").hide(),this.$el.find(".column-sizes .column-size").removeClass("active-size"),this.$el.find(".column-size-"+n).addClass("active-size"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.resized_column+" "+o,FusionPageBuilderEvents.trigger("fusion-element-edited"))},getColumnContent:function(e){var i,t="",n=void 0!==e?e:this.$el,o=n.data("cid"),a=FusionPageBuilderElements.findWhere({cid:o}),l={};return _.each(a.get("params"),function(e,i){l[i]="undefined"===e?"":e}),i={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(i,function(e,i){void 0===l[i]&&(l[i]=e)}),t+='[fusion_builder_column_inner type="'+a.get("layout")+'" background_position="'+l.background_position+'" background_color="'+l.background_color+'" border_size="'+l.border_size+'" border_color="'+l.border_color+'" border_style="'+l.border_style+'" spacing="'+l.spacing+'" background_image="'+l.background_image+'" background_repeat="'+l.background_repeat+'" padding_top="'+l.padding_top+'" padding_bottom="'+l.padding_bottom+'" padding_left="'+l.padding_left+'" padding_right="'+l.padding_right+'" margin_top="'+l.margin_top+'" margin_bottom="'+l.margin_bottom+'" class="'+l.class+'" id="'+l.id+'" animation_type="'+l.animation_type+'" animation_speed="'+l.animation_speed+'" animation_direction="'+l.animation_direction+'" hide_on_mobile="'+l.hide_on_mobile+'" center_content="'+l.center_content+'" last="'+l.last+'" min_height="'+l.min_height+'" hover_type="'+l.hover_type+'" link="'+l.link+'"]',n.find(".fusion_module_block").each(function(){t+=FusionPageBuilderApp.generateElementShortcode(s(this),!1)}),t+="[/fusion_builder_column_inner]"},getElementContent:function(){var e,i=this.$el,t=this.model,n={},o="";return _.each(t.get("params"),function(e,i){n[i]="undefined"===e?"":e}),e={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(e,function(e,i){void 0===n[i]&&(n[i]=e)}),o+='[fusion_builder_column_inner type="'+t.get("layout")+'" background_position="'+n.background_position+'" background_color="'+n.background_color+'" border_size="'+n.border_size+'" border_color="'+n.border_color+'" border_style="'+n.border_style+'" spacing="'+n.spacing+'" background_image="'+n.background_image+'" background_repeat="'+n.background_repeat+'" padding="'+n.padding+'" margin_top="'+n.margin_top+'" margin_bottom="'+n.margin_bottom+'" class="'+n.class+'" id="'+n.id+'" animation_type="'+n.animation_type+'" animation_speed="'+n.animation_speed+'" animation_direction="'+n.animation_direction+'" hide_on_mobile="'+n.hide_on_mobile+'" center_content="'+n.center_content+'" last="'+n.last+'" min_height="'+n.min_height+'" hover_type="'+n.hover_type+'" link="'+n.link+'"]',i.find(".fusion_module_block").each(function(){o+=FusionPageBuilderApp.generateElementShortcode(s(this),!1)}),o+="[/fusion_builder_column_inner]"}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(f){f(document).ready(function(){FusionPageBuilder.ColumnView=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(f("#fusion-builder-column-template").html()),events:{"click .fusion-builder-add-element:not(.fusion-builder-column-inner .fusion-builder-add-element)":"addModule","click .fusion-builder-settings-column:not(.fusion-builder-column-inner .fusion-builder-settings-column)":"showSettings","click .fusion-builder-resize-column:not(.fusion-builder-column-inner .fusion-builder-resize-column)":"columnSizeDialog","click .column-size:not(.fusion-builder-column-inner .column-size)":"columnSize","click .fusion-builder-clone-column:not(.fusion-builder-column-inner .fusion-builder-clone-column)":"cloneColumn","click .fusion-builder-remove-column:not(.fusion-builder-column-inner .fusion-builder-remove-column)":"removeColumn","click .fusion-builder-save-column-dialog:not(.fusion-builder-column-inner .fusion-builder-save-column-dialog)":"saveColumnDialog"},initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.$el.attr("data-column-size",this.model.get("layout"))},render:function(){var e,i;return this.$el.html(this.template(this.model.toJSON())),this.sortableElements(),e=this.model.get("layout"),this.$el.find(".column-size-"+e).addClass("active-size"),i=e.replace("_","/"),this.$el.find(".fusion-builder-resize-column").text(i),void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-column",this.model.attributes.params.fusion_global,this.model.get("cid")),this},sortableElements:function(){var a=this;this.$el.sortable({items:".fusion_module_block:not(.fusion_builder_row_inner .fusion_module_block), .fusion_builder_row_inner",connectWith:".fusion-builder-column-outer",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-add-element, .fusion-builder-insert-column, .fusion-builder-save-module-dialog, .fusion-builder-remove-inner-row, .fusion-builder-save-inner-row-dialog-button, .fusion-builder-remove-inner-row, .fusion_builder_row_inner .fusion-builder-row-content",tolerance:"pointer",over:function(e){1===f(e.target).find(".fusion_module_block, .fusion_builder_row_inner").length&&f(e.target).find(".ui-sortable-placeholder").insertBefore(f(e.target).find(".fusion-builder-add-element"))},update:function(e,i){var t=f(i.item),n=i.item.data("cid"),o=a.collection.find(function(e){return e.get("cid")===n});f(i.item).closest(e.target).length&&1===f(e.target).find(".fusion_module_block, .fusion_builder_row_inner").length&&t.insertBefore(f(e.target).find("> .fusion-builder-add-element")),o.get("parent")===a.model.attributes.cid&&f(i.item).closest(e.target).length||o.set("parent",a.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved+" "+fusionAllElements[o.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-sorted")}})},saveColumnDialog:function(e){e&&e.preventDefault(),FusionPageBuilderApp.showLibrary(),f("#fusion-builder-layouts-columns-trigger").click(),f("#fusion-builder-layouts-columns .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_column+"</a></div></div>")},saveElement:function(e){var i=this.$el,t=this.getColumnContent(i),n=f("#fusion_builder_main_container"),o=f("#fusion-builder-save-element-input").val(),a=f("#fusion_save_global").is(":checked"),l=f("#fusion-builder-layouts-columns .fusion-page-layouts"),s=f("#fusion-builder-layouts-columns .fusion-page-layouts .fusion-empty-library-message"),r=this.model,u=!1,d=null,c={};e&&e.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<n.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(d=this.model.attributes.params.fusion_global,delete(c=this.model.get("params")).fusion_global,this.model.set("params",c),t=this.getColumnContent(i),c.fusion_global=d,this.model.set("params",c)),f.each(jQuery("ul.fusion-page-layouts.fusion-layout-columns li"),function(){var e=jQuery(this).find("h4.fusion-page-layout-title").html().split("<div ")[0];if(o.toLowerCase().trim()===e.toLowerCase().trim())return alert(fusionBuilderText.duplicate_element_name_error),!(u=!0)}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==u&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==o?f.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_name:o,fusion_save_global:a,fusion_layout_content:t,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"columns"},complete:function(e){FusionPageBuilderApp.layoutIsSaving=!1,l.prepend(e.responseText),f(".fusion-save-element-fields").remove(),s.hide(),a&&(r.attributes.params.fusion_global=f(e.responseText).attr("data-layout_id"),f('div[data-cid="'+r.get("cid")+'"]').addClass("fusion-global-column"),f('div[data-cid="'+r.get("cid")+'"]').attr("fusion-global-layout",f(e.responseText).attr("data-layout_id")),f('div[data-cid="'+r.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+r.get("cid")+'"><span>'+fusionBuilderText.global_column+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0,setTimeout(FusionPageBuilderApp.checkGlobalParents,500,r.get("parent")))}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getColumnContent:function(e){var i,a="",t=e.data("cid"),n=FusionPageBuilderElements.findWhere({cid:t}),o={};return _.each(n.get("params"),function(e,i){o[i]="undefined"===e||void 0===e?"":e,"padding"===i&&""===o[i]&&(o.padding_top="",o.padding_right="",o.padding_bottom="",o.padding_left="",delete o[i]),"dimension_margin"===i&&""===o[i]&&(o.margin_top="",o.margin_bottom="",delete o[i])}),i={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(i,function(e,i){void 0===o[i]&&(o[i]=e)}),a+='[fusion_builder_column type="'+n.get("layout")+'"',_.each(o,function(e,i){a+=" "+i+'="'+e+'"'}),a+="]",e.find(".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)").each(function(){var e,i,t;f(this).hasClass("fusion_module_block")?a+=FusionPageBuilderApp.generateElementShortcode(f(this),!1):(i=(e=f(this)).data("cid"),void 0!==(t=FusionPageBuilderElements.findWhere({cid:i})).attributes.params&&void 0!==t.attributes.params.fusion_global?a+='[fusion_builder_row_inner fusion_global="'+t.attributes.params.fusion_global+'"]':a+="[fusion_builder_row_inner]",e.find(".fusion-builder-column-inner").each(function(){var e,i=f(this),t=i.data("cid"),n=FusionPageBuilderElements.findWhere({cid:t}),o={};_.each(n.get("params"),function(e,i){o[i]="undefined"===e||void 0===e?"":e}),e={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(e,function(e,i){void 0===o[i]&&(o[i]=e)}),a+='[fusion_builder_column_inner type="'+n.get("layout")+'"',_.each(o,function(e,i){a+=" "+i+'="'+e+'"'}),a+="]",i.find(".fusion_module_block").each(function(){a+=FusionPageBuilderApp.generateElementShortcode(f(this),!1)}),a+="[/fusion_builder_column_inner]"}),a+="[/fusion_builder_row_inner]")}),a+="[/fusion_builder_column]"},showSettings:function(e){var i,t={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};e&&e.preventDefault(),i=new FusionPageBuilder.ModalView(t),f("body").append(i.render().el)},removeColumn:function(e){var i,t;e&&e.preventDefault(),t=this.model.get("parent"),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){"fusion_builder_row"===e.model.get("type")||"fusion_builder_row_inner"===e.model.get("type")?e.removeRow():e.removeElement()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted+" "+fusionBuilderText.column,FusionPageBuilderEvents.trigger("fusion-element-removed")),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,t)},addModule:function(e){var i,t;e&&(e.preventDefault(),e.stopPropagation()),FusionPageBuilderApp.removeContextMenu(),FusionPageBuilderApp.innerColumn="false",FusionPageBuilderApp.parentColumnId=this.model.get("cid"),((t=f(e.target)).is("span")?t.parent(".fusion-builder-add-element"):t).parent().is(e.delegateTarget)&&(i=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_library"},view:this}),f("body").append(i.render().el))},cloneColumn:function(e){var s=f.extend(!0,{},this.model.attributes);e&&e.preventDefault(),s.created="manually",s.cid=FusionPageBuilderViewManager.generateCid(),s.targetElement=this.$el,s.cloned=!0,FusionPageBuilderApp.collection.add(s),this.$el.find(".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)").each(function(){var e,i,t,n,o,a,l;f(this).hasClass("fusion_module_block")?(e=f(this),i=void 0===e.data("cid")?e.find(".fusion-builder-data-cid").data("cid"):e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),(n=f.extend(!0,{},t.attributes)).created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),n.parent=s.cid,n.from="fusion_builder_column",FusionPageBuilderApp.collection.add(n)):f(this).hasClass("fusion_builder_row_inner")&&(a=void 0===(o=f(this)).data("cid")?o.find(".fusion-builder-data-cid").data("cid"):o.data("cid"),void 0!==(l=FusionPageBuilderViewManager.getView(a))&&l.cloneNestedRow("",s.cid))}),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned+" "+fusionBuilderText.column,FusionPageBuilderEvents.trigger("fusion-element-cloned"))},columnSizeDialog:function(e){e&&e.preventDefault(),this.$el.find(".column-sizes").toggle()},columnSize:function(e){var i=f(e.currentTarget),t=this.model.get("layout"),n=i.attr("data-column-size"),o="";e&&e.preventDefault(),void 0!==n&&(this.model.set("layout",n),this.$el.removeClass("fusion-builder-column-"+t),this.$el.addClass("fusion-builder-column-"+n),o=n.replace("_","/"),this.$el.find(".fusion-builder-resize-column").text(o),this.$el.find(".column-sizes").hide(),this.$el.find(".column-sizes .column-size").removeClass("active-size"),this.$el.find(".column-size-"+n).addClass("active-size"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.resized_column+" "+o,FusionPageBuilderEvents.trigger("fusion-element-edited"))}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(u){u(document).ready(function(){FusionPageBuilder.ModalView=window.wp.Backbone.View.extend({className:"fusion-builder-modal-settings-container",template:FusionPageBuilder.template(u("#fusion-builder-modal-template").html()),events:{"click .fusion-builder-modal-save":"saveSettings","click .fusion-builder-modal-close":"closeModal"},initialize:function(e){this.listenTo(FusionPageBuilderEvents,"fusion-columns-added",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-remove-modal-view",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-close-modal",this.closeModal),this.options=e,this.elementType=""},render:function(){var e,i,t,n={model:this.model,collection:this.collection,view:this.options.view};return void 0===this.model||void 0===this.model.get("view")||"row_inner"!==this.model.get("element_type")&&"fusion_builder_row"!==this.model.get("element_type")||this.model.get("parent")===this.model.get("view").$el.data("cid")||this.model.set("view",FusionPageBuilderViewManager.getView(this.model.get("parent")),{silent:!0}),void 0!==this.model?this.$el.html(this.template(this.model.toJSON())):this.$el.html(this.template()),t=this.$el.find(".fusion-builder-modal-container"),"column_library"===this.attributes["data-modal_view"]?e=new FusionPageBuilder.ColumnLibraryView(n):"element_library"===this.attributes["data-modal_view"]?(n.attributes={"data-parent_cid":this.model.get("cid")},e=new FusionPageBuilder.ElementLibraryView(n)):"all_elements_generator"===this.attributes["data-modal_view"]?(n.attributes={},e=new FusionPageBuilder.GeneratorElementsView(n)):"multi_element_child_settings"===this.attributes["data-modal_view"]?(n.attributes={},e=new FusionPageBuilder.MultiElementSettingsView(n)):"element_settings"===this.attributes["data-modal_view"]&&(n.attributes={"data-element_type":this.model.get("element_type")},void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")&&(this.elementType="multi"),n.view=this,e=void 0!==(i=fusionAllElements[this.model.get("element_type")].custom_settings_view_name)&&""!==i?new FusionPageBuilder[i](n):new FusionPageBuilder.ElementSettingsView(n)),t.append(e.render().el),u(".fusion_builder_modal_overlay").length<1&&u(".fusion_builder_modal_inner_row_overlay").length<1&&u("body").addClass("fusion_builder_no_scroll").append('<div class="fusion_builder_modal_overlay"></div>'),"column_library"!==this.attributes["data-modal_view"]&&"element_library"!==this.attributes["data-modal_view"]&&"all_elements_generator"!==this.attributes["data-modal_view"]||this.elementSearchFilter(),"multi"===this.elementType&&this.$el.addClass("fusion_builder_modal_multi_element_settings_container"),this},closeModal:function(e){var i,t,n,o,a,l,s,r;e&&e.preventDefault(),FusionPageBuilderApp.activeModal="",this.$el.find(".wp-color-picker").each(function(){u(this).wpColorPicker("close")}),FusionPageBuilderApp.codeEditor&&FusionPageBuilderApp.codeEditor.toTextArea(),!0===FusionPageBuilderApp.newContainerAdded&&(FusionPageBuilderApp.newContainerAdded=!1),this.$el.find(".tinymce").each(function(){s=u(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(s)}),void 0!==this.model&&!0!==FusionPageBuilderApp.MultiElementChildSettings&&"undefined"!==this.model.get("added")&&"manually"===this.model.get("added")?fusionHistoryManager.turnOnTracking():FusionPageBuilderApp.MultiElementChildSettings=!1,!0===FusionPageBuilderApp.shortcodeGenerator?void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")?(FusionPageBuilderApp.shortcodeGeneratorMultiElement="",FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",FusionPageBuilderApp.shortcodeGenerator="",r=this.$el.find(".fusion-builder-option-advanced-module-settings").data("cid"),FusionPageBuilderViewManager.getView(r).removeView(),r=""):void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_child"===this.model.get("multi")?FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="":(FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID=""):"undefined"!==this.model.get("added")&&"manually"===this.model.get("added")&&("fusion_builder_row"===this.model.get("element_type")?(i=this.model.get("parent"),void 0!==(t=FusionPageBuilderViewManager.getView(i))&&t.removeContainer()):(o=fusionAllElements[this.model.get("element_type")].params,n={},_.each(o,function(e){a=_.isObject(e.value)?e.default:e.value,n[e.param_name]=a}),l={params:n},this.model.set(l),e&&FusionPageBuilderEvents.trigger("fusion-element-added")),"element"===this.model.get("type")&&this.deleteModel(),void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")&&FusionPageBuilderEvents.trigger("fusion-multi-remove-sortables-view")),this.removeOverlay(),FusionPageBuilderEvents.trigger("fusion-settings-modal-cancel"),this.remove()},removeView:function(){this.removeOverlay(),void 0!==this.model&&"fusion_builder_row"!==this.model.get("type")&&"fusion_builder_column"!==this.model.get("type")&&"fusion_builder_row_inner"!==this.model.get("type")&&"fusion_builder_column_inner"!==this.model.get("type")||this.remove()},saveSettings:function(e){var n,i,t,o,a,l=this;e&&e.preventDefault(),this.$el.find(".wp-color-picker").each(function(){u(this).wpColorPicker("close")}),FusionPageBuilderApp.codeEditor&&FusionPageBuilderApp.codeEditor.toTextArea(),!0!==FusionPageBuilderApp.MultiElementChildSettings?fusionHistoryManager.turnOnTracking():FusionPageBuilderApp.MultiElementChildSettings=!1,n={params:{}},"fusion_builder_container"===this.model.get("element_type")&&void 0!==this.model.attributes.params.admin_label&&(n.params.admin_label=this.model.attributes.params.admin_label),void 0!==this.model.attributes.params.fusion_global&&(n.params.fusion_global=this.model.attributes.params.fusion_global),this.$el.find("input, select, textarea, #fusion_builder_content_main, #fusion_builder_content_main_child, #generator_element_content, #generator_multi_child_content, #element_content").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){var e,i,t=u(this);i=l.getSettingName(t,!1),e=l.getSettingValue(t,!1),n.params[i]=e}),void 0!==fusionAllElements[this.model.get("element_type")].escape_html&&!0===fusionAllElements[this.model.get("element_type")].escape_html&&(n.params.element_content=_.escape(n.params.element_content)),void 0!==fusionAllElements[this.model.get("element_type")].on_save&&(o=fusionAllElements[this.model.get("element_type")].on_save,"function"==typeof FusionPageBuilderApp[o]&&(n=FusionPageBuilderApp[o](n,this))),!0===FusionPageBuilderApp.shortcodeGenerator?"multi_element_parent"===this.model.get("multi")?(this.model.set(n,{silent:!0}),i=FusionPageBuilderApp.generateElementShortcode(this.model,!1,!0),fusionBuilderInsertIntoEditor(i),FusionPageBuilderApp.shortcodeGeneratorMultiElement="",FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",FusionPageBuilderApp.shortcodeGenerator="",void 0!==(a=this.$el.find(".fusion-builder-option-advanced-module-settings").data("cid"))&&FusionPageBuilderViewManager.getView(a).removeView(),a="",this.remove(),this.removeOverlay()):"multi_element_child"===this.model.get("multi")?(this.model.set(n),FusionPageBuilderEvents.trigger("fusion-multi-element-edited"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",this.remove()):("fusion_builder_column"===this.model.get("element_type")&&(n.params.type=this.model.get("layout")),"fusion_builder_container"===this.model.get("element_type")&&(n.params.element_content="[fusion_builder_row][/fusion_builder_row]"),this.model.set(n,{silent:!0}),i=FusionPageBuilderApp.generateElementShortcode(this.model,!1,!0),fusionBuilderInsertIntoEditor(i,FusionPageBuilderApp.shortcodeGeneratorEditorID),"video"!==FusionPageBuilderApp.shortcodeGeneratorEditorID&&(FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID=""),this.remove(),!1!==FusionPageBuilderApp.builderActive&&!0!==FusionPageBuilderApp.fromExcerpt||(this.removeOverlay(),FusionPageBuilderApp.fromExcerpt=!1)):("multi_element_child"===this.model.get("multi")?(this.model.set(n,{silent:!0}),FusionPageBuilderEvents.trigger("fusion-multi-element-edited"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),this.remove()):("multi_element_parent"===this.model.get("multi")?(void 0===this.model.get("added")&&(window.fusionHistoryState=fusionBuilderText.edited+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.model.unset("added"),this.model.set(n),this.$el.find(".tinymce").each(function(){t=u(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(t)}),FusionPageBuilderEvents.trigger("fusion-multi-remove-sortables-view"),this.remove(),FusionPageBuilderEvents.trigger("fusion-modal-view-removed"),this.generatePreview()):(void 0===this.model.get("added")&&(window.fusionHistoryState=fusionBuilderText.edited+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.model.unset("added"),this.model.set(n),this.$el.find(".tinymce").each(function(){t=u(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(t)}),this.remove(),FusionPageBuilderEvents.trigger("fusion-modal-view-removed"),!0===FusionPageBuilderApp.builderActive&&this.generatePreview()),this.removeOverlay()),e&&FusionPageBuilderEvents.trigger("fusion-element-added")),FusionPageBuilderApp.manuallyAdded&&(FusionPageBuilderApp.shortcodeGenerator=FusionPageBuilderApp.manualGenerator,FusionPageBuilderApp.shortcodeGeneratorEditorID=FusionPageBuilderApp.manualEditor,FusionPageBuilderApp.manuallyAdded=!1),this.$el.find(".tinymce").each(function(){t=u(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(t)}),FusionPageBuilderApp.activeModal="",FusionPageBuilderEvents.trigger("fusion-settings-modal-save")},getSettingName:function(e,i){if(!e.parents(".repeater-fields").length||i)return e.is("#generator_element_content")||e.is("#fusion_builder_content_main")||e.is("#element_content")||e.is("#generator_multi_child_content")?"element_content":e.attr("id")},getSettingValue:function(e,i){var t;if(!e.parents(".repeater-fields").length||i)return e.is("#fusion_builder_content_main")?t=e.val():e.is(":checkbox")||(t=e.is("#generator_element_content")?fusionBuilderGetContent("generator_element_content"):e.is("#generator_multi_child_content")?fusionBuilderGetContent("generator_multi_child_content"):e.is("textarea#element_content")&&e.parents(".fusion-builder-option").hasClass("tinymce")?fusionBuilderGetContent("element_content"):e.val()),e.is("input")&&""!==t&&(e.hasClass("fusion-builder-upload-field")||e.is("#generator_element_content")||e.is("#generator_multi_child_content")||(t=_.escape(t))),e.hasClass("fusion-builder-raw-textarea")&&(t=FusionPageBuilderApp.base64Encode(t)),e.hasClass("fusion-builder-code-block")&&1===Number(FusionPageBuilderApp.disable_encoding)&&(t=FusionPageBuilderApp.base64Encode(t)),e.hasClass("fusion-repeater-value")&&(t=this.getRepaterValues(e)),"infobox_content"===name&&(t=_.escape(t)),t},getRepaterValues:function(e){var n,i=[],o=this;return e.parent().find(".repeater-row").each(function(){n={},jQuery(this).find("input, select, textarea, #fusion_builder_content_main, #fusion_builder_content_main_child, #generator_element_content, #generator_multi_child_content, #element_content").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){var e=jQuery(this),i=o.getSettingName(e,!0),t=o.getSettingValue(e,!0);n[i]=t}),i.push(n)}),i=JSON.stringify(i),i=FusionPageBuilderApp.base64Encode(i)},removeOverlay:function(){u(".fusion_builder_modal_overlay").length&&u(".fusion-builder-modal-settings-container").length<2&&(u(".fusion_builder_modal_overlay").remove(),u("body").removeClass("fusion_builder_no_scroll"))},generatePreview:function(){var e,i,t,n,o,a=this.model.get("element_type");"fusion_builder_container"===a&&(n=this.model.get("params"),i=FusionPageBuilderViewManager.getView(this.model.get("cid")).$el,o=fusionBuilderText.empty_section,""!==n.background_image&&(o=fusionBuilderText.empty_section_with_bg),i.find(".fusion-builder-empty-section").html(o),FusionPageBuilderViewManager.getView(this.model.get("cid")).updateStatusIcons()),void 0!==fusionAllElements[a].preview&&(e={model:this.model,collection:FusionPageBuilderElements},i=FusionPageBuilderViewManager.getView(this.model.get("cid")).$el.find(".fusion-builder-module-preview"),t=new FusionPageBuilder.ElementPreviewView(e),i.html("").append(t.render().el))},deleteModel:function(){FusionPageBuilderViewManager.getView(this.model.get("cid")).$el.find(".fusion-builder-remove").click()},elementSearchFilter:function(){var e,i,t=this.$el;t.find(".fusion-elements-filter").on("change paste keyup",function(){u(this).val()?(i=u(this).val().toLowerCase(),t.find(".fusion-builder-all-modules li").each(function(){"portfolio"===(e=(e=u(this).find(".fusion_module_title").text().trim().toLowerCase()).replace("this is a global column.",""))&&(e+=" recent works"),-1!==e.search(i)?u(this).show():u(this).hide()})):t.find(".fusion-builder-all-modules li").show()})}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.NextPage=window.wp.Backbone.View.extend({className:"fusion-builder-next-page",template:FusionPageBuilder.template(e("#fusion-builder-next-page-template").html()),events:{"click .fusion-builder-delete-next-page":"removeContainer"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},removeContainer:function(e){e&&e.preventDefault(),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&FusionPageBuilderEvents.trigger("fusion-element-removed")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.ContextMenuView=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(jQuery("#fusion-builder-context-menu").html()),className:"fusion-builder-context-menu",events:{'click [data-action="edit"]':"editTrigger",'click [data-action="save"]':"saveTrigger",'click [data-action="clone"]':"cloneTrigger",'click [data-action="remove"]':"removeTrigger",'click [data-action="copy"]':"copy",'click [data-action="paste-before"]':"pasteBefore",'click [data-action="paste-after"]':"pasteAfter",'click [data-action="paste-start"]':"pasteStart",'click [data-action="paste-end"]':"pasteEnd"},initialize:function(){this.copyData={data:{type:!1,content:!1}},this.getCopy()},render:function(){var e=jQuery("#fusion_builder_layout .inside").offset();return this.$el.html(this.template(jQuery.extend(!0,this.copyData,this.model.parent.attributes,{pageType:this.model.pageType}))),this.$el.css({top:this.model.event.pageY-e.top+"px",left:this.model.event.pageX-e.left+"px"}),this},editTrigger:function(e){"fusion_builder_row_inner"===this.model.parent.attributes.element_type?this.model.parentView.showInnerRowDialog(e):this.model.parentView.showSettings(e)},saveTrigger:function(e){"fusion_builder_column"===this.model.parent.attributes.element_type?this.model.parentView.saveColumnDialog(e):this.model.parentView.saveElementDialog(e)},cloneTrigger:function(e){switch(this.model.parent.attributes.element_type){case"fusion_builder_container":this.model.parentView.cloneContainer(e);break;case"fusion_builder_column_inner":case"fusion_builder_column":this.model.parentView.cloneColumn(e);break;case"fusion_builder_row_inner":this.model.parentView.cloneNestedRow(e);break;default:this.model.parentView.cloneElement(e)}},removeTrigger:function(e){switch(this.model.parent.attributes.element_type){case"fusion_builder_container":this.model.parentView.removeContainer(e);break;case"fusion_builder_column_inner":case"fusion_builder_column":this.model.parentView.removeColumn(e);break;case"fusion_builder_row_inner":this.model.parentView.removeRow(e);break;default:this.model.parentView.removeElement(e)}},copy:function(){var e,i,t=this.model.parent.attributes.element_type,n=jQuery("<textarea>");switch(this.model.parent.attributes.element_type){case"fusion_builder_container":e=this.model.parentView.getContainerContent();break;case"fusion_builder_column_inner":case"fusion_builder_column":e=this.model.parentView.getColumnContent(this.model.parentView.$el);break;case"fusion_builder_row_inner":e=this.model.parentView.getInnerRowContent();break;default:e=this.model.parentView.getElementContent()}jQuery("body").append(n),n.val(e).select(),document.execCommand("copy"),n.remove(),i={type:t,content:e},this.storeCopy(i)},storeCopy:function(e){"undefined"!=typeof Storage&&(localStorage.setItem("fusionCopyContent",e.content),localStorage.setItem("fusionCopyType",e.type),this.getCopy())},getCopy:function(){"undefined"!=typeof Storage&&localStorage.getItem("fusionCopyContent")&&(this.copyData.data.content=localStorage.getItem("fusionCopyContent"),this.copyData.data.type=localStorage.getItem("fusionCopyType"))},pasteAfter:function(){this.paste("after")},pasteBefore:function(){this.paste("before")},pasteStart:function(){this.paste("start")},pasteEnd:function(){this.paste("end")},paste:function(e){var i,t=this.copyData.data,n=t.type,o=t.content,a=!1,l="";"after"===e||"before"===e?(i=this.model.parent.attributes.parent,a=this.model.parentView.$el,"fusion_builder_container"===this.model.parent.attributes.type&&(i=this.model.parent.attributes.cid,FusionPageBuilderApp.targetContainerCID=this.model.parent.attributes.cid)):(i=this.model.parent.attributes.cid,a=!1,"fusion_builder_container"===this.model.parent.attributes.type&&(i=this.model.parentView.$el.find(".fusion-builder-row-content").first().data("cid"))),FusionPageBuilderApp.shortcodesToBuilder(o,i,a,e),-1===n.indexOf("fusion_builder_")&&(l=" "+fusionBuilderText.element),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.pasted+" "+fusionAllElements[n].name+l,FusionPageBuilderEvents.trigger("fusion-element-cloned")},removeMenu:function(e){e&&e.preventDefault(),FusionPageBuilderApp.contextMenuView=!1,this.remove()}})});FusionPageBuilder=FusionPageBuilder||{};!function(N){N(document).ready(function(){FusionPageBuilder.ElementSettingsView=window.wp.Backbone.View.extend({className:"fusion_builder_module_settings",template:FusionPageBuilder.template(N("#fusion-builder-block-module-settings-template").html()),events:{"click #qt_element_content_fusion_shortcodes_text_mode":"activateSCgenerator"},activateSCgenerator:function(e){openShortcodeGenerator(N(e.target))},initialize:function(){var e,i,t;this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.removeElement),void 0!==fusionAllElements[this.model.get("element_type")].on_settings&&(e=fusionAllElements[this.model.get("element_type")].on_settings,"function"==typeof FusionPageBuilderApp[e]&&(i=this.model.get("params"),t=FusionPageBuilderApp[e](i,this),this.model.set("params",t)))},render:function(){var e=this.$el;return e.html(this.template({atts:this.model.attributes})),this.optionInit(e),setTimeout(function(){e.find("select, input, textarea, radio").filter(":eq(0)").not("[data-placeholder]").focus()},1),void 0!==this.model&&void 0!==this.model.get&&FusionPageBuilderApp.checkOptionDependency(fusionAllElements[this.model.get("element_type")],e),FusionPageBuilderEvents.trigger("fusion-settings-modal-open"),this},optionInit:function(e){var i,t,n,o,a,l,s,r,u,d,c,f,m,g,p,h,_,b,v,y,w,B,P,F,C,E,k,A,x,j,T,V,M,Q,S,$,D,I=e,O="",L=!1,z=this,G=!1,H=[];"undefined"!==(w=this.model).attributes.params.settings_lvl&&"parent"===w.attributes.params.settings_lvl&&(G=!0,T=w.attributes.params),void 0!==w.get&&void 0!==w.get("allow_generator")&&!0===w.get("allow_generator")&&(FusionPageBuilderApp.allowShortcodeGenerator=!0),S=void 0!==this.model.get&&void 0!==this.model.get("parent_values")&&this.model.get("parent_values"),A=I.find("[data-placeholder]"),t=I.find(".fusion-editor-field"),o=I.find(".fusion-builder-color-picker-hex"),a=I.find(".fusion-builder-upload-button"),l=I.find(".fusion-iconpicker"),s=I.find(".fusion-form-multiple-select"),r=I.find(".fusion-form-checkbox-button-set"),u=I.find(".fusion-form-radio-button-set"),v=I.find(".fusion-slider-container"),B=I.find(".fusion-select-field"),F=I.find(".single-builder-dimension"),E=I.find(".fusion-builder-code-block"),V=I.find(".fusion-builder-link-button"),M=I.find(".fusion-datetime"),Q=I.find(".fusion-multiple-image-container"),$=I.find(".fusion-builder-option.repeater"),A.length&&A.on("focus",function(e){jQuery(e.target).data("placeholder")===jQuery(e.target).val()&&jQuery(e.target).val("")}),V.length&&FusionPageBuilderApp.fusionBuilderActivateLinkSelector(V),M.length&&jQuery(M).fusiondatetimepicker({format:"yyyy-MM-dd hh:mm:ss"}),o.length&&o.each(function(){var t=N(this),n=t.parents(".fusion-builder-option").find(".fusion-builder-default-reset"),o=void 0!==S&&void 0!==S[t.attr("id")]&&S[t.attr("id")];N(this).data("default")&&N(this).data("default").length?(N(this).wpColorPicker({change:function(e,i){z.colorChange(i.color.toString(),t,n,o)},clear:function(e){z.colorClear(e,t,o)}}),n.on("click","a",function(e){e.preventDefault(),z.colorClear(e,t,o)})):N(this).wpColorPicker({}),!0!==N(this).data("alpha")&&N(this).wpColorPicker().change()}),Q.length&&Q.each(function(){var i,t=jQuery(this);t.html(""),"string"==typeof t.parent().find("#image_ids").val()&&(i=t.parent().find("#image_ids").val().split(","),jQuery.each(i,function(e,i){""!==i&&"NaN"!==i&&void 0===wp.media.attachment(i).get("url")&&H.push(i)}),0<H.length?wp.media.query({post__in:H,posts_per_page:H.length}).more().then(function(e){z.renderAttachments(i,t)}):z.renderAttachments(i,t))}),E.length&&E.each(function(){var e;void 0!==wp.CodeMirror&&(C=N(this).attr("id"),k=I.find("#"+C),e=jQuery(this).data("language"),void 0!==(D=I.find("."+C).val())&&((D=jQuery.parseJSON(D)).lineNumbers=!0),void 0!==e&&"default"!==e&&(D.mode="text/"+e),FusionPageBuilderApp.codeEditor=wp.CodeMirror.fromTextArea(k[0],D),setTimeout(function(){FusionPageBuilderApp.codeEditor.refresh(),FusionPageBuilderApp.codeEditor.focus()},100))}),F.length&&F.each(function(){jQuery(this).find(".fusion-builder-dimension input").on("change paste keyup",function(){jQuery(this).parents(".single-builder-dimension").find('input[type="hidden"]').val((jQuery(this).parents(".single-builder-dimension").find("div:nth-child(1) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(1) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(2) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(2) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(3) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(3) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(4) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(4) input").val():"0px"))})}),B.length&&B.select2(),a.length&&FusionPageBuilderApp.FusionBuilderActivateUpload(a),l.length&&l.each(function(){var e=jQuery(this);d=e.find(".fusion-iconpicker-input").val(),c=e.find(".fusion-iconpicker-input").attr("id"),f=e.find(".icon_select_container"),m=e.find(".fusion-icon-search"),FusionPageBuilderApp.fusion_builder_iconpicker(d,c,f,m)}),s.length&&s.each(function(){x=fusionBuilderText.select_options_or_leave_blank_for_all,-1!==jQuery(this).attr("id").indexOf("cat_slug")||-1!==jQuery(this).attr("id").indexOf("category")?x=fusionBuilderText.select_categories_or_leave_blank_for_all:-1!==jQuery(this).attr("id").indexOf("exclude_cats")&&(x=fusionBuilderText.select_categories_or_leave_blank_for_none),jQuery(this).select2({placeholder:x})}),r.length&&((_=I.find(".fusion-form-checkbox-button-set.hide_on_mobile")).length&&("no"!==(b=_.find(".button-set-value").val())&&""!==b||_.find("a").addClass("ui-state-active"),"yes"===b&&_.find('a:not([data-value="small-visibility"])').addClass("ui-state-active")),r.find("a").on("click",function(e){e.preventDefault(),p=jQuery(this).parents(".fusion-form-checkbox-button-set"),jQuery(this).toggleClass("ui-state-active"),p.find(".button-set-value").val(p.find(".ui-state-active").map(function(e,i){return jQuery(i).data("value")}).get())})),u.length&&u.find("a").on("click",function(e){e.preventDefault(),(h=jQuery(this).parents(".fusion-form-radio-button-set")).find(".ui-state-active").removeClass("ui-state-active"),jQuery(this).addClass("ui-state-active"),h.find(".button-set-value").val(h.find(".ui-state-active").data("value")).trigger("change")}),v.length&&(y=0,Number.prototype.countDecimals=function(){return Math.floor(this.valueOf())===this.valueOf()?0:this.toString().split(".")[1].length||0},v.each(function(){var e=jQuery(this).data("id"),i=jQuery(this).prev(".fusion-slider-input"),t=jQuery(this).data("min"),n=jQuery(this).data("max"),o=jQuery(this).data("step"),a=jQuery(this).data("direction"),l=i.val(),s=o.countDecimals(),r=!!jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").length&&jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default"),u=!!r&&jQuery(this).parent().find(".fusion-hidden-value"),d=!!r&&jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").data("default");void 0!==S&&void 0!==S[e]&&r&&(jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").data("default",S[e]),d=S[e],u&&""!==u.val()||(l=d)),function(i,t,e,n,o,a,l,s,r,u,d,c){var f=noUiSlider.create(v[i],{start:[l],step:a,direction:c,range:{min:n,max:o},format:wNumb({decimals:s})}),m=!1;r&&""===u.val()&&r.parent().addClass("checked"),r&&r.on("click",function(e){e.preventDefault(),v[i].noUiSlider.set(d),u.val(""),jQuery(this).parent().addClass("checked")}),f.on("update",function(e,i){r&&m&&(r.parent().removeClass("checked"),u.val(e[i])),m=!0,jQuery(this.target).closest(".fusion-slider-container").prev().val(e[i]).trigger("change"),I.find("#"+t).trigger("change")}),e.on("blur",function(e){this.value!==v[i].noUiSlider.get()&&(n<=this.value&&o>=this.value?v[i].noUiSlider.set(this.value):n>this.value?v[i].noUiSlider.set(n):o<this.value&&v[i].noUiSlider.set(o))})}(y,e,i,t,n,o,l,s,r,u,d,a),y++})),void 0!==this.model.get&&"fusion_woo_shortcodes"===this.model.get("element_type")&&!0===FusionPageBuilderApp.shortcodeGenerator&&I.find("#element_content").attr("id","generator_element_content"),t.length&&(n=t.closest(".fusion-builder-option"),void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")?(g=FusionPageBuilderViewManager.generateCid(),this.view_cid=g,n.hide(),t.attr("id","fusion_builder_content_main"),i=new FusionPageBuilder.MultiElementSortablesView({model:this,el:this.$el.find(".fusion-builder-option-advanced-module-settings"),attributes:{cid:g,parentCid:this.model.get("cid")}}),FusionPageBuilderViewManager.addView(g,i),n.before(i.render()),""!==t.html()&&i.generateMultiElementChildSortables(t.html(),I.find(".fusion-builder-option-advanced-module-settings").data("element_type"),G,T)):(O=t.html(),!0===FusionPageBuilderApp.shortcodeGenerator?(!0===FusionPageBuilderApp.shortcodeGeneratorMultiElementChild?t.attr("id","generator_multi_child_content"):t.attr("id","generator_element_content"),P=t.attr("id"),setTimeout(function(){t.wp_editor(O,P),jQuery("#"+P).data("placeholder")&&window.tinyMCE.get(P).on("focus",function(){j=window.tinyMCE.get(P).getContent(),(j=jQuery("<div/>").html(j).text())===jQuery("#"+P).data("placeholder")&&window.tinyMCE.get(P).setContent("")})},100)):(P=t.attr("id"),setTimeout(function(){void 0!==w.get("allow_generator")&&!0===w.get("allow_generator")&&(L=!0),t.wp_editor(O,P,L),jQuery("#"+P).data("placeholder")&&window.tinyMCE.get(P).on("focus",function(){j=window.tinyMCE.get(P).getContent(),(j=jQuery("<div/>").html(j).text())===jQuery("#"+P).data("placeholder")&&window.tinyMCE.get(P).setContent("")})},100)))),$.length&&$.each(function(){z.initRepeater(jQuery(this))}),I.find(".uploadattachment .fusion-builder-upload-button").on("click",function(){alert(fusionBuilderText.to_add_images)}),FusionPageBuilderApp.rangeOptionPreview(I)},removeElement:function(){this.remove()},initRepeater:function(e){var t=this,i=e.data("option-id"),n=fusionAllElements[this.model.get("element_type")].params[i],o=void 0!==n?n.fields:{},a=this.model.get("params"),l=void 0!==a[i]?a[i]:"",s=e.find(".repeater-rows"),r=void 0!==n&&n.row_title,u=!1;if("string"==typeof l&&""!==l)try{FusionPageBuilderApp.base64Encode(FusionPageBuilderApp.base64Decode(l))===l&&(l=FusionPageBuilderApp.base64Decode(l),l=_.unescape(l),l=JSON.parse(l),u=!0)}catch(e){}else t.createRepeaterRow(o,{},s,r);"object"==typeof l&&u&&_.each(l,function(e,i){t.createRepeaterRow(o,l[i],s,r)}),e.on("click",".repeater-row-add",function(e){e.preventDefault(),t.createRepeaterRow(o,{},s,r)}),e.on("click",".repeater-row-remove",function(e){e.preventDefault(),jQuery(this).parents(".repeater-row").first().remove()}),e.on("click",".repeater-title",function(){jQuery(this).parent().find(".repeater-fields").slideToggle(300),jQuery(this).find(".repeater-toggle-icon").hasClass("fusiona-plus2")?jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-plus2").addClass("fusiona-minus"):jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-minus").addClass("fusiona-plus2")}),e.sortable({handle:".repeater-title",items:".repeater-row",cursor:"move",cancel:".repeater-row-remove",update:function(){}})},createRepeaterRow:function(e,i,t,n){var o,a="",l=FusionPageBuilder.template(jQuery("#fusion-app-repeater-fields").html()),s={};a+='<div class="repeater-row">',a+='<div class="repeater-title">',a+='<span class="repeater-toggle-icon fusiona-plus2"></span>',a+="<h3>"+(n=void 0!==n&&n?n:"Repeater Row")+"</h3>",a+='<span class="repeater-row-remove fusiona-plus2"></span>',a+="</div>",a+='<ul class="repeater-fields">',_.each(e,function(e){o=i[e.param_name],s[e.param_name]=e,a+=jQuery(l({field:e,value:o})).html()}),a+="</ul>",a+="</div>",this.optionInit(t.append(a).children("div:last-child")),void 0!==this.model&&void 0!==this.model.get&&FusionPageBuilderApp.checkOptionDependency(fusionAllElements[this.model.get("element_type")],t.children("div:last-child"),!1,s,this.$el)},colorChange:function(e,i,t){var n=i.data("default");e===n?t.addClass("checked"):t.removeClass("checked"),""===e&&null!==n&&(i.val(n),i.change(),i.val(""))},colorClear:function(e,i){var t=i.data("default");null!==t&&(i.val(t),i.change(),i.val(""),i.parent().parent().find(".wp-color-result").css("background-color",t))},renderAttachments:function(e,t){var n,o,a,l;0<e.length&&jQuery.each(e,function(e,i){""!==i&&"NaN"!==i&&(o=wp.media.attachment(i),a=o.get("sizes"),l=void 0!==a[200]?a[200].url:void 0!==a.thumbnail?a.thumbnail.url:o.get("url"),n='<div class="fusion-multi-image" data-image-id="'+o.get("id")+'">',n+='<img src="'+l+'"/>',n+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',n+="</div>",t.append(n))})}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.MultiElementSettingsView=FusionPageBuilder.ElementSettingsView.extend({events:{"click .insert-slider-video":"addSliderVideo"},addSliderVideo:function(e){var i,t,n,o;e&&e.preventDefault(),FusionPageBuilderApp.manualGenerator=FusionPageBuilderApp.shortcodeGenerator,FusionPageBuilderApp.manualEditor=FusionPageBuilderApp.shortcodeGeneratorEditorID,FusionPageBuilderApp.manuallyAdded=!0,FusionPageBuilderApp.shortcodeGenerator=!0,FusionPageBuilderApp.shortcodeGeneratorEditorID="video",n=a(e.currentTarget).data("type"),i=fusionAllElements[n].params,t={},_.each(i,function(e){o=_.isObject(e.value)?e.default:e.value,t[e.param_name]=o}),this.collection.add([{type:"generated_element",added:"manually",element_type:n,params:t}])}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(n){n(document).ready(function(){FusionPageBuilder.MultiElementSortablesView=window.wp.Backbone.View.extend({initialize:function(){!0===FusionPageBuilderApp.shortcodeGenerator&&(FusionPageBuilderApp.shortcodeGeneratorMultiElement=!0),this.listenTo(FusionPageBuilderEvents,"fusion-multi-element-edited",this.generateContent),this.listenTo(FusionPageBuilderEvents,"fusion-multi-remove-sortables-view",this.removeView),this.element_type=this.$el.data("element_type"),this.child_views=[],this.fetchIds=[],this.childIds=[],this.updateGallery=!1,this.$el.attr("data-cid",this.attributes.cid),this.$sortable_options=this.$el.find(".fusion-builder-sortable-options"),this.$sortable_options.sortable({axis:"y",cancel:".fusion-builder-multi-setting-remove, .fusion-builder-multi-setting-options, .fusion-builder-multi-setting-clone",helper:"clone",update:function(){FusionPageBuilderEvents.trigger("fusion-multi-element-edited")}}),this.$add_sortable_item=this.$el.find(".fusion-builder-add-multi-child").addClass("fusion-builder-add-sortable-initial")},events:{"click .fusion-builder-add-multi-child":"addChildElement"},render:function(){return this},addChildElement:function(e){var i,t,n,o={};e&&e.preventDefault(),i=fusionAllElements[this.element_type].params,n=void 0!==fusionAllElements[this.element_type].allow_generator?fusionAllElements[this.element_type].allow_generator:"",_.each(i,function(e){t=_.isObject(e.value)?e.default:e.value,o[e.param_name]=t}),this.model.collection.add([{type:"element",element_type:this.element_type,cid:FusionPageBuilderViewManager.generateCid(),view:this,created:"manually",multi:"multi_element_child",child_element:"true",parent:this.attributes.cid,params:o,allow_generator:n}]),this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")},generateContent:function(){var i="";this.$sortable_options.find("li").each(function(){var e=n(this);i+=FusionPageBuilderApp.generateElementShortcode(e,!1)}),this.$el.parents().find("#fusion_builder_content_main").html(i),this.$sortable_options.find("li").length?this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"):this.$add_sortable_item.addClass("fusion-builder-add-sortable-initial")},updateGalleryContent:function(){var i="",t=this,e=FusionPageBuilderApp.collection.find(function(e){return e.get("cid")===t.attributes.parentCid});this.$sortable_options.find("li").each(function(){var e=n(this);i+=FusionPageBuilderApp.generateElementShortcode(e,!1)}),e.attributes.params.element_content=i,this.$el.parents().find("#fusion_builder_content_main").html(i),this.$sortable_options.find("li").length?this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"):this.$add_sortable_item.addClass("fusion-builder-add-sortable-initial"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),FusionPageBuilderEvents.trigger("fusion-element-added"),this.fetchIds=[],this.childIds=[]},removeView:function(e){e&&e.preventDefault(),this.remove()},generateMultiElementChildSortables:function(e,g,p,h){var b=this,i=jQuery.map(fusionMultiElements,function(e,i){return e}).join("|"),t=window.wp.shortcode.regexp(i),v=FusionPageBuilderApp.regExpShortcode(i),n=e.match(t);this.updateGallery=!1,""!==e&&this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"),_.each(n,function(e){var i,t,n,o,a,l,s=e.match(v),r=s[2],u=""!==s[3]?window.wp.shortcode.attrs(s[3]):"",d=s[5],c="",f=(FusionPageBuilderViewManager.generateCid(),{params:{}}),m=void 0!==fusionAllElements[r].allow_generator?fusionAllElements[r].allow_generator:"";if(void 0!==u.named&&void 0!==u.named.title&&u.named.title.length?c=u.named.title:void 0!==u.named&&void 0!==u.named.title_front&&u.named.title_front.length?c=u.named.title_front:void 0!==u.named&&void 0!==u.named.name&&u.named.name.length?(c=u.named.name,void 0!==u.named.company&&u.named.company.length&&(c+=", "+u.named.company)):void 0!==u.named&&void 0!==u.named.name&&u.named.name.length?c=u.named.name:void 0!==u.named&&void 0!==u.named.image&&u.named.image.length&&"fusion_testimonial"!==r?-1!==(c=u.named.image).indexOf("/")&&-1===c.indexOf("[")&&(c=(c=c.split("/")).slice(-1)[0]):void 0!==u.named&&"image"===u.named.type&&void 0!==d&&d.length?-1!==(c=d).indexOf("/")&&-1===c.indexOf("[")&&(c=(c=c.split("/")).slice(-1)[0]):void 0!==u.named&&void 0!==u.named.video&&u.named.video.length?c=u.named.video:void 0!==u.named&&void 0!==d&&d.length&&(c=d),c=jQuery("<div/>").html(c).text(),c=jQuery("<div/>").html(c).text(),i={type:"element",element_type:g,element_name:c,cid:FusionPageBuilderViewManager.generateCid(),view:b,created:"auto",multi:"multi_element_child",child_element:"true",allow_generator:m,params:{},parent:b.attributes.cid},_.isObject(u.named)){for(t in u.named)n=t,("fusion_builder_column"===r&&"type"===n||"fusion_builder_column_inner"===r&&"type"===n)&&(f[n="layout"]=u.named[t]),f.params[n]=u.named[t];i=_.extend(i,f)}i.params.element_content=d,void 0!==fusionAllElements[r].option_dependency&&(o=fusionAllElements[r].option_dependency,a=f.params[o],l=f.params.element_content,f.params[a]=l),!0===p&&"fusion_content_box"===g&&(i.params.iconcolor="",i.params.backgroundcolor="",i.params.circlecolor="",i.params.circlebordercolor="",i.params.circlebordersize="",i.params.outercirclebordercolor="",i.params.outercirclebordersize="",i.params.animation_type=h.animation_type,i.params.animation_direction=h.animation_direction,i.params.animation_speed=h.animation_speed,i.params.link_target=h.link_target),"fusion_gallery"===b.model.attributes["data-element_type"]&&(void 0!==i.params.image&&""!==i.params.image||""!==i.params.image_id&&"NaN"!==i.params.image_id&&void 0!==i.params.image_id&&(void 0===wp.media.attachment(i.params.image_id).get("url")?(b.fetchIds.push(i.params.image_id),b.childIds.push(i.cid)):i.params.image=wp.media.attachment(i.params.image_id).get("url"),b.updateGallery=!0)),b.model.collection.add([i])}),"fusion_gallery"===b.model.attributes["data-element_type"]&&b.updateGallery&&(void 0!==b.fetchIds&&0<b.fetchIds.length?wp.media.query({post__in:b.fetchIds,posts_per_page:b.fetchIds.length}).more().then(function(){_.each(b.childIds,function(i){var e=FusionPageBuilderApp.collection.find(function(e){return e.get("cid")===i});void 0!==wp.media.attachment(e.attributes.params.image_id).get("url")&&(e.attributes.params.image=wp.media.attachment(e.attributes.params.image_id).get("url"))}),setTimeout(function(){b.updateGalleryContent()},200)}):setTimeout(function(){b.updateGalleryContent()},200))}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(o){o(document).ready(function(){FusionPageBuilder.MultiElementSortableChild=window.wp.Backbone.View.extend({tagName:"li",className:"fusion-builder-data-cid",initialize:function(){this.template=FusionPageBuilder.template(o("#fusion-builder-multi-child-sortable").html()),this.listenTo(FusionPageBuilderEvents,"fusion-multi-child-update-preview",this.updatePreview)},events:{"click .fusion-builder-multi-setting-options":"showSettings","click .fusion-builder-multi-setting-remove":"removeView","click .fusion-builder-multi-setting-clone":"cloneElement"},render:function(){return this.$el.html(this.template({atts:this.model.attributes})),this},cloneElement:function(e){var i,t=this.$el.find(".multi-element-child-name").html();e&&e.preventDefault(),(i=o.extend(!0,{},this.model.attributes)).created="manually",i.cid=FusionPageBuilderViewManager.generateCid(),i.cloned=!0,i.targetElement=this.$el,i.titleLabel=t,FusionPageBuilderApp.collection.add(i),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")},showSettings:function(e){var i,t,n={};e&&e.preventDefault(),(FusionPageBuilderApp.MultiElementChildSettings=!0)===FusionPageBuilderApp.shortcodeGenerator&&(FusionPageBuilderApp.shortcodeGeneratorMultiElementChild=!0),jQuery(document).find(".fusion-builder-option.range .fusion-hidden-value, .wp-color-picker, .has-child-dependency input, .has-child-dependency select, .has-child-dependency textarea, .has-child-dependency #fusion_builder_content_main, .has-child-dependency #fusion_builder_content_main_child").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){jQuery(this).val().length&&(n[jQuery(this).attr("id")]=jQuery(this).val())}),this.model.set({parent_values:n}),t={model:this.model,collection:this.collection,attributes:{"data-modal_view":"multi_element_child_settings"}},i=new FusionPageBuilder.ModalView(t),o(".fusion_builder_modal_multi_element_settings_container").last().after(i.render().el)},updatePreview:function(){var e,i,t,n,o=this.model.attributes,a=this.model;void 0!==o&&(e="",void 0!==o.params.title&&o.params.title.length?e=o.params.title:"fusion_flip_box"===a.get("element_type")&&void 0!==o.params.title_front&&o.params.title_front.length?e=o.params.title_front:"fusion_testimonial"===a.get("element_type")&&void 0!==o.params.name&&o.params.name.length?(e=o.params.name,void 0!==o.params.company&&o.params.company.length&&(e+=", "+o.params.company)):"fusion_testimonial"===a.get("element_type")&&void 0!==o.params.name&&o.params.name.length?e=o.params.name:void 0!==o.params.image&&o.params.image.length&&"fusion_testimonial"!==a.get("element_type")?(e=o.params.image,-1!==(i=e).indexOf("/")&&-1===e.indexOf("[")&&(e=(e=e.split("/")).slice(-1)[0]),_.isEmpty(e)&&(e=fusionBuilderText.image)):void 0!==o.params.video&&o.params.video.length?e=o.params.video:void 0!==o.params.element_content&&o.params.element_content.length&&(e=o.params.element_content),e=jQuery("<div/>").html(e).text(),(e=jQuery("<div/>").html(e).text())&&(e='<span class="fusion-child-name-label">'+e+"</span>",_.isEmpty(i)?jQuery("li[data-cid="+a.get("cid")+"] .multi-element-child-name").html(e):(0===(t=i.substr(i.lastIndexOf("."))).indexOf(".")&&(i=(i=i.replace(/-\d+x\d+\./,".")).replace(t,"-66x66"+t)),(n=new Image).src=i,n.onload=function(){e='<img class="fusion-child-element-image" src="'+i+'" >'+e,jQuery("li[data-cid="+a.get("cid")+"] .multi-element-child-name").html(e)},n.onerror=function(){e='<span class="fusion-image-placeholder fusiona fusiona-image"></span>'+e,jQuery("li[data-cid="+a.get("cid")+"] .multi-element-child-name").html(e)})))},removeView:function(e){e&&e.preventDefault(),this.remove(),this.model.destroy(),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(r){r(document).ready(function(){FusionPageBuilder.ColumnLibraryView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(r("#fusion-builder-column-library-template").html()),events:{"click .fusion-builder-column-layouts li":"addColumns","click .fusion_builder_custom_columns_load":"addCustomColumn","click .fusion_builder_custom_sections_load":"addCustomSection","click .fusion-builder-section-next-page":"addNextPage"},initialize:function(e){this.listenTo(FusionPageBuilderEvents,"fusion-columns-added",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.removeView),this.options=e},render:function(){var e=this;return this.$el.html(this.template(this.model.toJSON())),FusionPageBuilderApp.showSavedElements("columns",this.$el.find("#custom-columns")),"container"===FusionPageBuilderApp.activeModal&&FusionPageBuilderApp.showSavedElements("sections",this.$el.find("#custom-sections")),setTimeout(function(){e.$el.find(".fusion-elements-filter").focus()},50),this},addCustomColumn:function(t){var e,i,n,o;t&&t.preventDefault(),FusionPageBuilderApp.activeModal="column",!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,e=this.model,i=r(t.currentTarget).data("layout_id"),o=r(t.currentTarget).find(".fusion_module_title").text(),n=r(t.currentTarget).closest("li").hasClass("fusion-global"),r(t.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),r(t.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),r.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:n,fusion_layout_id:i},success:function(e){var i=JSON.parse(e);FusionPageBuilderApp.shortcodesToBuilder(i.post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,r(t.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),r(t.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide(),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,FusionPageBuilderApp.parentRowId)},complete:function(){e.unset("added"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_custom_column+o,FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}}))},addColumns:function(e){var o,i,a,l,s;e&&e.preventDefault(),FusionPageBuilderApp.activeModal="column",o=this,i=(r(e.target).is("li")?r(e.target):r(e.target).closest("li")).data("layout").split(","),_.size(i),a=this.options.view,l=fusionAllElements.fusion_builder_column.params,_.each(i,function(e,i){var t,n={};_.each(l,function(e){s=_.isObject(e.value)?e.default:e.value,n[e.param_name]=s}),t={type:"fusion_builder_column",element_type:"fusion_builder_column",cid:FusionPageBuilderViewManager.generateCid(),parent:o.model.get("cid"),layout:e,view:a,params:n},o.collection.add([t])}),this.model.unset("added"),FusionPageBuilderEvents.trigger("fusion-columns-added"),e&&(fusionHistoryManager.turnOnTracking(),!0===FusionPageBuilderApp.newContainerAdded?(window.fusionHistoryState=fusionBuilderText.added_section,FusionPageBuilderApp.newContainerAdded=!1):window.fusionHistoryState=fusionBuilderText.added_columns,FusionPageBuilderEvents.trigger("fusion-element-added"))},removeView:function(){FusionPageBuilderApp.activeModal="",this.remove()},addCustomSection:function(t){var e,i,n,o,a=this.model,l=this.model.get("parent"),s=FusionPageBuilderViewManager.getView(l);o=s.$el.prev(".fusion_builder_container"),FusionPageBuilderApp.targetContainerCID=o.find(".fusion-builder-data-cid").data("cid"),t&&t.preventDefault(),void 0!==s&&s.removeContainer(),!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,e=r(t.currentTarget).data("layout_id"),n=r(t.currentTarget).find(".fusion_module_title").text(),i=r(t.currentTarget).closest("li").hasClass("fusion-global"),r(t.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),r(t.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),r.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:i,fusion_layout_id:e},success:function(e){var i=JSON.parse(e);FusionPageBuilderApp.shortcodesToBuilder(i.post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,r(t.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),r(t.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide()},complete:function(){a.unset("added"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_custom_section+n,FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}}))},addNextPage:function(e){var i,t,n=this.model.get("parent"),o=FusionPageBuilderViewManager.getView(n);e&&e.preventDefault(),i=o.$el.prev(".fusion_builder_container"),FusionPageBuilderApp.targetContainerCID=i.find(".fusion-builder-data-cid").data("cid"),t=FusionPageBuilderViewManager.generateCid(),this.collection.add([{type:"fusion_builder_next_page",added:"manually",module_type:"fusion_builder_next_page",cid:t,params:{},view:o,appendAfter:i,created:"auto"}]),void 0!==o&&(FusionPageBuilderApp.targetContainerCID="",o.removeContainer()),FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(r){r(document).ready(function(){FusionPageBuilder.NestedColumnLibraryView=window.wp.Backbone.View.extend({className:"fusion-builder-modal-settings-container",template:FusionPageBuilder.template(r("#fusion-builder-nested-column-library-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element":"addModule","click .fusion_builder_custom_elements_load":"addCustomModule","click .fusion-builder-column-layouts li":"addNestedColumns","click .fusion-builder-modal-close":"closeModal"},initialize:function(e){this.options=e,this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.remove)},render:function(){return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),this.$el.addClass("fusion-add-to-nested"),this},addNestedColumns:function(e){var n,i,o,t,a,l,s;e&&e.preventDefault(),FusionPageBuilderViewManager.generateCid(),s=this.$el.parents(".fusion-builder-row-content").find(".fusion-builder-row-container-inner"),n=this,i=(r(e.target).is("li")?r(e.target):r(e.target).closest("li")).data("layout").split(","),_.size(i),o=this.options.view,t=fusionAllElements.fusion_builder_column_inner.params,a={},_.each(t,function(e){l=_.isObject(e.value)?e.default:e.value,a[e.param_name]=l}),_.each(i,function(e,i){var t={type:"fusion_builder_column_inner",element_type:"fusion_builder_column_inner",cid:FusionPageBuilderViewManager.generateCid(),parent:FusionPageBuilderApp.parentRowId,layout:e,view:o,params:a,appendAfter:s};n.collection.add([t])}),this.remove(),FusionPageBuilderEvents.trigger("fusion-columns-added"),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned"))},closeModal:function(e){e.preventDefault(),this.remove()}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};var FusionPageBuilderEvents=_.extend({},Backbone.Events);function openShortcodeGenerator(e){var i,t="#"+e.parent().parent().find(".wp-editor-area").attr("id");window.cursorPosition=0,window.editorArea=t,FusionPageBuilderApp.shortcodeGenerator=!0,FusionPageBuilderApp.isTinyMceActive()?window.SCmoduleContentEditorMode="tinymce":window.SCmoduleContentEditorMode="html","tinymce"!==window.SCmoduleContentEditorMode&&(window.cursorPosition=jQuery(t).getCursorPosition()),i=new FusionPageBuilder.ModalView({model:this.model,collection:FusionPageBuilderElements,attributes:{"data-modal_view":"all_elements_generator"},view:this}),jQuery("body").append(i.render().el)}!function(C){var f,m,t;C.fn.outerHTML=function(){return this.length?this[0].outerHTML||(e=this[0],(t=document.createElement("div")).appendChild(e.cloneNode(!0)),i=t.innerHTML,t=null,i):this;var e,i,t},window.fusionBuilderGetContent=function(e,i,t){var n;if(void 0===i&&(i=!1),void 0===t&&(t=!1),t||void 0===window.tinyMCE||!window.tinyMCE.get(e)||window.tinyMCE.get(e).isHidden()?C("#"+e).length&&(n=C("#"+e).val().replace(/\r?\n/g,"\r\n")):n=window.tinyMCE.get(e).getContent(),i&&void 0!==window.tinyMCE&&void 0!==n&&(n=(n=n.replace(/<p>\[/g,"[")).replace(/\]<\/p>/g,"]")),void 0!==n)return n.trim()},f=C(".icon_select_container .icon_preview"),t=0,m=function(e,i){clearTimeout(t),t=setTimeout(e,i)},C(window).load(function(){C("#fusion_toggle_builder").data("enabled")&&C("#fusion_toggle_builder").trigger("click")}),C("#publishing-action #publish").on("click",function(){FusionPageBuilderApp.saveGlobal=!1}),C(window).bind("beforeunload",function(){var e="undefined"!=typeof tinymce&&tinymce.get("content");if((e&&!e.isHidden()&&e.isDirty()||wp.autosave&&wp.autosave.server.postChanged())&&!0===FusionPageBuilderApp.saveGlobal&&!C("#publish").hasClass("disable"))return FusionPageBuilderApp.saveGlobal=!1,""}),C(document).ready(function(){var e,t,n,o,a,i,l,s,r,u;function d(){var e=document.getElementById("fusion_builder_controls");fusionBuilderStickyHeader(e,jQuery("#wpadminbar").height())}function c(){FusionPageBuilderElements.reset(),FusionPageBuilderViewManager.set("elementCount",0),FusionPageBuilderViewManager.set("views",{}),C("#fusion_builder_container").html(""),FusionPageBuilderApp.shortcodeGenerator=!1}C(document).click(function(e){C(e.target).parents(".column-sizes").length||C(e.target).hasClass("fusion-builder-resize-column")||C(".column-sizes").hide()}),FusionPageBuilder.AppView=window.wp.Backbone.View.extend({el:C("#fusion_builder_main_container"),template:FusionPageBuilder.template(C("#fusion-builder-app-template").html()),events:{"click .fusion-builder-layout-button-save":"saveLayout","click .fusion-builder-layout-button-load":"loadLayout","click .fusion-builder-layout-button-delete":"deleteLayout","click .fusion-builder-layout-buttons-clear":"clearLayout","click .fusion-builder-demo-button-load":"loadDemoPage","click .fusion-builder-layout-custom-css":"customCSS","click .fusion-builder-template-buttons-save":"saveTemplateDialog","click #fusion-builder-layouts .fusion-builder-modal-close":"hideLibrary","click .fusion-builder-library-dialog":"openLibrary","mouseenter .fusion-builder-layout-buttons-history":"showHistoryDialog","mouseleave .fusion-builder-layout-buttons-history":"hideHistoryDialog","click .fusion-builder-element-button-save":"saveElement","click #fusion-load-template-dialog":"loadPreBuiltPage","click .fusion-builder-layout-buttons-toggle-containers":"toggleAllContainers","click .fusion-builder-global-tooltip":"unglobalize","click .fusion-builder-publish-tooltip":"publish",contextmenu:"contextMenu"},initialize:function(){this.builderActive=!1,this.pauseBuilder=!1,this.ajaxurl=fusionBuilderConfig.ajaxurl,this.fusion_load_nonce=fusionBuilderConfig.fusion_load_nonce,this.fusion_builder_plugin_dir=fusionBuilderConfig.fusion_builder_plugin_dir,this.layoutIsLoading=!1,this.layoutIsSaving=!1,this.saveGlobal=!1,this.layoutIsDeleting=!1,this.parentRowId="",this.parentColumnId="",this.targetContainerCID="",this.activeModal="",this.innerColumn="",this.blankPage="",this.newLayoutLoaded=!1,this.newContainerAdded=!1,this.fullWidth=fusionBuilderConfig.full_width,this.allContent="",this.shortcodeGenerator="",this.shortcodeGeneratorMultiElement="",this.shortcodeGeneratorMultiElementChild="",this.allowShortcodeGenerator="",this.shortcodeGeneratorActiveEditor="",this.shortcodeGeneratorEditorID="",this.manuallyAdded=!1,this.manualGenerator=!1,this.manualEditor="",this.fromExcerpt=!1,this.disable_encoding=fusionBuilderConfig.disable_encoding,this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.codeEditor="",this.MultiElementChildSettings=!1,this.listenTo(this.collection,"add",this.addBuilderElement),this.listenTo(FusionPageBuilderEvents,"fusion-element-added",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-removed",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-cloned",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-edited",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-sorted",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-added",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-element-cloned",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-element-edited",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-element-sorted",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-show-loader",this.showLoader),this.listenTo(FusionPageBuilderEvents,"fusion-hide-loader",this.hideLoader),this.listenTo(FusionPageBuilderEvents,"fusion-hide-library",this.hideLibrary),this.listenTo(FusionPageBuilderEvents,"fusion-save-layout",this.saveLayout),this.listenTo(FusionPageBuilderEvents,"fusion-save-history-state",this.saveHistoryState),this.toggledContainers=!0,this.render(),jQuery("body").hasClass("gutenberg-editor-page")||(C("#fusion_toggle_builder").hasClass("fusion_builder_is_active")&&this.initialBuilderLayout(!0),fusionHistoryManager.turnOnTracking(),fusionHistoryManager.captureEditor(),fusionHistoryManager.turnOffTracking()),this.contextMenuView=!1,this.clipboard={}},render:function(){return this.$el.html(this.template()),this.sortableContainers(),this},unglobalize:function(e){var i=jQuery(e.currentTarget).data("cid"),t=FusionPageBuilderViewManager.getView(i),n=t.model.get("params"),o=t.model.get("element_type");if(!1===confirm(fusionBuilderText.are_you_sure_you_want_to_remove_global))return!1;delete n.fusion_global,t.model.set("params",n),t.$el.removeClass("fusion-global-element fusion-global-container fusion-global-column"),jQuery(e.currentTarget).remove(),t.$el.removeAttr("fusion-global-layout"),"fusion_builder_container"===o&&t.$el.find(".fusion-builder-container-content > .fusion-builder-section-content").removeAttr("fusion-global-layout"),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.removed_global,FusionPageBuilderEvents.trigger("fusion-element-edited")},publish:function(e){var i=jQuery(e.currentTarget).data("cid"),t=FusionPageBuilderViewManager.getView(i),n=t.model.get("params");if(!1===confirm(fusionBuilderText.are_you_sure_you_want_to_publish))return!1;n.status="published",t.model.set("params",n),t.updateStatusIcons(),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.container_published,FusionPageBuilderEvents.trigger("fusion-element-edited")},isTinyMceActive:function(){return"undefined"!=typeof tinyMCE&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()},base64Encode:function(e){var i,t,n,o,a,l,s=this._keyStr,r=0,u=0,d="",c=[];if(!e)return e;for(e=unescape(encodeURIComponent(e));i=(a=e.charCodeAt(r++)<<16|e.charCodeAt(r++)<<8|e.charCodeAt(r++))>>18&63,t=a>>12&63,n=a>>6&63,o=63&a,c[u++]=s.charAt(i)+s.charAt(t)+s.charAt(n)+s.charAt(o),r<e.length;);return d=c.join(""),((l=e.length%3)?d.slice(0,l-3):d)+"===".slice(l||3)},base64Decode:function(e){var i,t,n,o,a,l,s="",r=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");r<e.length;)i=this._keyStr.indexOf(e.charAt(r++))<<2|(o=this._keyStr.indexOf(e.charAt(r++)))>>4,t=(15&o)<<4|(a=this._keyStr.indexOf(e.charAt(r++)))>>2,n=(3&a)<<6|(l=this._keyStr.indexOf(e.charAt(r++))),s+=String.fromCharCode(i),64!==a&&(s+=String.fromCharCode(t)),64!==l&&(s+=String.fromCharCode(n));return s=this.utf8Decode(s)},utf8Decode:function(e){for(var i,t="",n=0,o=0,a=0;n<e.length;)(o=e.charCodeAt(n))<128?(t+=String.fromCharCode(o),n++):191<o&&o<224?(a=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&a),n+=2):(a=e.charCodeAt(n+1),i=e.charCodeAt(n+2),t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&i),n+=3);return t},fusionBuilderMCEremoveEditor:function(e){void 0!==window.tinyMCE&&(window.tinyMCE.execCommand("mceRemoveEditor",!1,e),void 0!==window.tinyMCE.get(e)&&window.tinyMCE.remove("#"+e))},fusion_builder_iconpicker:function(t,e,i,n){var o=jQuery(".fusion-icons-rendered").html(),a="",l=jQuery(i),s=l.parent(),r=this;""!==t&&void 0===(t=t.split(" "))[1]&&(t[1]="fas",void 0!==window["fusion-fontawesome-free-shims"]&&(a=t[0].substr(3),jQuery.each(window["fusion-fontawesome-free-shims"],function(e,i){if(i[0]===a)return null!==i[2]&&(t[0]="fa-"+i[2]),null!==i[1]&&(t[1]=i[1]),!1})),s.find(".fusion-iconpicker-input").attr("value",t[0]+" "+t[1])),l.html(o).addClass("fusion-icons-hidden"),2===t.length&&(l.find("."+t[0]+"."+t[1]).parent().addClass("selected-element").css("display","inline-block"),l.prepend(l.find(".selected-element"))),s.find(".icon_select_container, .fusion-icon-search").on("mouseover focus",function(){l.hasClass("fusion-icons-hidden")&&(r.showIcons(l),l.removeClass("fusion-icons-hidden"))}),jQuery(n).on("change paste keyup",function(){var i=jQuery(this);m(function(){var e;if(i.val()){if((t=i.val().toLowerCase()).length<3)return;l.find(".icon_preview").css("display","none"),e=new Fuse(fusionIconSearch,{threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["name","keywords","categories"]}).search(t),_.each(e,function(e){l.find(".icon-fa-"+e.name).css("display","inline-block")})}else l.find(".icon_preview").css("display","inline-block")},100)})},showIcons:function(e){var i=this;setTimeout(function(){e.find(".icon_preview:hidden").each(function(e,i){if(jQuery(this).css("display","inline-block"),750<e)return!1}),e.find(".icon_preview:hidden").length&&i.showIcons(e)},100)},contextMenu:function(e){var i,t,n,o=this,a=jQuery(e.target),l=a.closest("[data-cid]:not(.fusion-builder-row-content)"),s="default";if(!a.hasClass("fusion_builder_blank_page")&&!a.closest(".fusion_builder_blank_page").length){if(a.data("cid")&&(l=a),a.hasClass("fusion-builder-section-header")||a.closest(".fusion-builder-section-header").length){if(a.hasClass("fusion-builder-section-name"))return;l=a.closest(".fusion_builder_container").find(".fusion-builder-section-content").first()}if(this.removeContextMenu(),e.preventDefault(),t=FusionPageBuilderViewManager.getView(l.data("cid"))){if(n=this.getElementType(t.model.attributes.element_type),jQuery("body").hasClass("fusion-builder-library-edit")&&!a.closest(".fusion-builder-row-container-inner").length){if(jQuery("body").hasClass("fusion-element-post-type-sections")&&(s="container"),jQuery("body").hasClass("fusion-element-post-type-columns")&&(s="column","fusion_builder_container"===n))return;if(jQuery("body").hasClass("fusion-element-post-type-elements")&&(s="element","fusion_builder_container"===n||"fusion_builder_column"===n||"fusion_builder_column_inner"===n))return}t&&(i={model:{parent:t.model,event:e,parentView:t,pageType:s}},this.contextMenuView=new FusionPageBuilder.ContextMenuView(i),this.$el.append(this.contextMenuView.render().el),this.$el.one("click",function(){o.removeContextMenu()}))}}},removeContextMenu:function(){this.contextMenuView&&"function"==typeof this.contextMenuView.removeMenu&&this.contextMenuView.removeMenu()},getElementType:function(e){return"fusion_builder_container"===e||"fusion_builder_column"===e||"fusion_builder_column_inner"===e?e:e in fusionMultiElements?"parent_element":-1!==_.values(fusionMultiElements).indexOf(e)?"child_element":"fusion_builder_row_inner"===e&&FusionPageBuilderApp.pauseBuilder?"fusion_builder_row_inner":"element"},fusionBuilderImagePreview:function(e){var i,t,n=e.siblings(".fusion-builder-upload-field"),o=n.siblings(".fusion-builder-upload-preview"),a=e.siblings(".upload-image-remove"),l=n.val().trim();if(i=0<=l.indexOf("<img")?l:'<img src="'+l+'" />',"image"===e.data("type")&&!e.hasClass("hide-edit-buttons")){if(""===l)return o.length&&(o.remove(),a.remove(),e.val("Upload Image")),t=e.parents(".fusion-builder-option").next().find("#"+e.data("param")+"_id"),"element_content"===e.data("param")&&(t=e.parents(".fusion-builder-option").next().find("#image_id")),void(t.length&&t.val(""));o.length||(e.siblings(".preview").before('<div class="fusion-builder-upload-preview"><strong class="fusion-builder-upload-preview-title">Preview</strong><div class="fusion-builder-preview-image"><img src="" width="300" height="300" /></div></div>'),e.after('<input type="button" class="button upload-image-remove" value="Remove" />'),e.val("Edit"),o=n.siblings(".fusion-builder-upload-preview")),o.find("img").replaceWith(i)}},FusionBuilderActivateUpload:function(e){e.click(function(e){var c,a,o,l,i,f=!1,m=!1,g="",s="",p=C(this).closest(".fusion_builder_module_settings").data("element_type"),h=C(this).closest(".fusion-builder-option").data("option-id");return e&&e.preventDefault(),"fusion-multiple-upload"===(c=C(this)).data("id")&&(f=!0),"fusion-multiple-images"===c.data("id")&&(m=!0,o=jQuery(c.next(".fusion-multiple-image-container"))[0],l=jQuery(c).prev(".fusion-multi-image-input")),a=wp.media({library:{type:c.data("type")},title:c.data("title"),multiple:!(!f&&!m)&&"between",frame:"post",className:"media-frame mode-select fusion-builder-media-dialog "+c.data("id"),displayUserSettings:!1,displaySettings:!0,allowLocalEdits:!0}),wp.media.frames.file_frame=a,m&&"fusion_gallery"===p&&(i=l.val(),s="string"==typeof i?i.split(","):"",[],"",wp.media._galleryDefaults.link="none",wp.media._galleryDefaults.size="thumbnail",a.options.syncSelection=!0,a.options.state=void 0!==i&&""!==i?"gallery-edit":"gallery"),a.on("open",function(){var e,i,t=a.state().get("selection"),n=a.state().get("library"),o=[];m?("fusion_gallery"===p&&"gallery-edit"===a.options.state||C(".fusion-builder-media-dialog").addClass("hide-menu"),jQuery.each(s,function(e,i){""!==i&&"NaN"!==i&&(void 0!==wp.media.attachment(i).get("url")?(t.add(wp.media.attachment(i)),n.add(wp.media.attachment(i))):o.push(i))}),0<o.length&&wp.media.query({post__in:o,posts_per_page:o.length}).more().then(function(){jQuery.each(s,function(e,i){""!==i&&"NaN"!==i&&(t.add(wp.media.attachment(i)),n.add(wp.media.attachment(i)))})})):(void 0!==(i=c.parents(".fusion-builder-module-settings").find("#image_id").val())&&""!==i&&(i=i.split("|")[0]),e=wp.media.attachment(i),C(".fusion-builder-media-dialog").addClass("hide-menu"),i&&(e.fetch(),t.add(e?[e]:[])))}),m&&"fusion_gallery"===p&&a.on("update",function(e){var i,t="";i=e.map(function(e){var i=e.id;return e.attributes.sizes&&void 0!==e.attributes.sizes.thumbnail?t=e.attributes.sizes.thumbnail.url:e.attributes.url&&(t=e.attributes.url),m&&(g+='<div class="fusion-multi-image" data-image-id="'+i+'">',g+='<img src="'+t+'"/>',g+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',g+="</div>"),e.id}),l.val(i),jQuery(o).html(g)}),a.on("select insert",function(){var s,r,u,e,i,t,n,d=a.state();void 0===d.get("selection")?s=jQuery(a.$el).find("#embed-url-field").val():(e=d.get("selection").map(function(e){return e.id}),m&&l.val(e),f&&(i=jQuery(c).parents(".fusion-builder-main-settings").find(".fusion-builder-sortable-options li:first-child")).length&&(t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i.data("cid")}))&&void 0===t.attributes.params[h]&&jQuery(c).parents(".fusion-builder-main-settings").find(".fusion-builder-sortable-options li:first-child .fusion-builder-multi-setting-remove").trigger("click"),d.get("selection").map(function(t){var n,e,i,o=t.toJSON(),a=d.display(t).toJSON(),l={};r=o.id,u=a.size,o.sizes&&o.sizes[a.size]&&o.sizes[a.size].url?s=o.sizes[a.size].url:o.url&&(s=o.url),m&&(g+='<div class="fusion-multi-image" data-image-id="'+r+'">',g+='<img src="'+s+'"/>',g+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',g+="</div>"),f&&(n=fusionAllElements[p].element_child,e=fusionAllElements[p].params[h].child_params,i=void 0===fusionAllElements[p].params[h].create_children||fusionAllElements[p].params[h].create_children,_.each(e,function(e,i){l[i]=fusionAllElements[n].params[i].value}),_.each(e,function(e,i){fusionAllElements[n].params[i].value=t.attributes[e]}),"image"===h&&(fusionAllElements[p].params[h+"_id"].value=r+"|"+u),i&&(jQuery(c).parents(".fusion-builder-main-settings").find(".fusion-builder-add-multi-child").trigger("click"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview")),_.each(l,function(e,i){fusionAllElements[n].params[i].value=e}))})),jQuery(o).html(g),f||m||(c.siblings(".fusion-builder-upload-field").val(s).trigger("change"),n=c.parents(".fusion-builder-option").next().find("#"+h+"_id"),"element_content"===h&&(n=c.parents(".fusion-builder-option").next().find("#image_id")),n.length&&n.val(r+"|"+u),FusionPageBuilderApp.fusionBuilderImagePreview(c))}),a.open(),!1}),e.siblings(".fusion-builder-upload-field").on("input",function(){FusionPageBuilderApp.fusionBuilderImagePreview(C(this).siblings(".fusion-builder-upload-button"))}),e.siblings(".fusion-builder-upload-field").each(function(){FusionPageBuilderApp.fusionBuilderImagePreview(C(this).siblings(".fusion-builder-upload-button"))}),jQuery("body").on("click",".fusion-multi-image-remove",function(){var e,i,t,n=jQuery(this).parents(".fusion-multiple-upload-images").find(".fusion-multi-image-input");i=jQuery(this).parent(".fusion-multi-image").data("image-id"),-1!==(t=(e=n.val().split(",").map(function(e){return parseInt(e,10)})).indexOf(i))&&e.splice(t,1),e=e.join(","),n.val(e),jQuery(this).parent(".fusion-multi-image").remove()})},fusionBuilderActivateLinkSelector:function(e){var t,n,o=jQuery("#wp-link-submit"),a=jQuery(".wp-link-text-field"),l=jQuery(".link-target"),s=jQuery('<input type="button" name="fusion-link-submit" id="fusion-link-submit" class="button-primary" value="Set Link">'),r=window.wpLink,u=window.wpLinkL10n;jQuery(e).click(function(i){s.insertBefore(o),t=jQuery(i.target).prev(".fusion-builder-link-field"),n=t.val(),o.hide(),a.hide(),l.hide(),s.show(),(r=!window.wpLink&&C.fn.wpdialog&&jQuery("#wp-link").length?{$link:!1,open:function(){this.$link=jQuery("#wp-link").wpdialog({title:u.title,width:480,height:"auto",modal:!0,dialogClass:"wp-dialog",zIndex:3e5})},close:function(){this.$link.wpdialog("close")}}:window.wpLink).fusionUpdateLink=function(e){i.preventDefault(),i.stopImmediatePropagation(),i.stopPropagation(),n=jQuery("#wp-link-url").length?jQuery("#wp-link-url").val():jQuery("#url-field").val(),t.val(n).trigger("change"),o.show(),a.show(),l.show(),e.remove(),jQuery("#wp-link-cancel").unbind("click"),r.close()},r.open("fusion-custom-css-field"),jQuery("#wp-link-url").val(n)}),jQuery("body").on("click","#fusion-link-submit",function(){r.fusionUpdateLink(jQuery(this))}),jQuery("body").on("click","#wp-link-cancel, #wp-link-close, #wp-link-backdrop",function(){o.show(),a.show(),l.show(),s.remove()})},fusionBuilderSetContent:function(e,i){void 0!==window.tinyMCE&&window.tinyMCE.get(e)&&!window.tinyMCE.get(e).isHidden()?(window.tinyMCE.get(e).getParam("wpautop",!0)&&void 0!==window.switchEditors&&(i=window.switchEditors.wpautop(i)),window.tinyMCE.get(e).setContent(i,{format:"html"})):C("#"+e).val(i)},layoutLoaded:function(){this.newLayoutLoaded=!0},clearLayout:function(e){if(e&&e.preventDefault(),!1===confirm(fusionBuilderText.are_you_sure_you_want_to_delete_this_layout))return!1;this.blankPage=!0,this.clearBuilderLayout(!0),fusionHistoryManager.clearEditor("blank")},showHistoryDialog:function(e){e&&e.preventDefault(),this.$el.find(".fusion-builder-history-list").show()},hideHistoryDialog:function(e){e&&e.preventDefault(),this.$el.find(".fusion-builder-history-list").hide()},saveTemplateDialog:function(e){e&&e.preventDefault(),this.showLibrary(),C("#fusion-builder-layouts-templates-trigger").click()},loadPreBuiltPage:function(e){e&&e.preventDefault(),this.showLibrary(),C("#fusion-builder-layouts-demos-trigger").click()},saveLayout:function(e){var i,t,n,o,a,l,s,r,u,d=[];e&&e.preventDefault(),jQuery('input[id^="pyre_"], select[id^="pyre_"]').each(function(e){r=jQuery(this).attr("id"),u=jQuery(this).val(),void 0!==r&&void 0!==u&&(d[e]=[r,u])}),i=fusionBuilderGetContent("content",!0),t=C("#new_template_name").val(),n=C("#fusion-builder-layouts-templates .fusion-page-layouts"),o=C("#fusion_builder_main_container").data("post-id"),a=C("#fusion-builder-layouts-templates .fusion-page-layouts .fusion-empty-library-message"),l=C("#fusion-custom-css-field").val(),s=C("#page_template").val(),""!==t?(C.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_name:t,fusion_layout_content:i,fusion_layout_post_type:"fusion_template",fusion_current_post_id:o,fusion_custom_css:l,fusion_page_template:s,fusion_options:d},complete:function(e){n.prepend(e.responseText),a.hide()}}),C("#new_template_name").val("")):alert(fusionBuilderText.please_enter_template_name)},saveElement:function(e){var i;e&&e.preventDefault(),C(e.currentTarget).data("element-type"),i=C(e.currentTarget).data("element-cid"),FusionPageBuilderViewManager.getView(i).saveElement()},loadLayout:function(e){var i,t,n,o;e&&e.preventDefault(),!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,i=C(e.currentTarget).closest("li"),t=C(e.currentTarget).data("load-type"),n=fusionBuilderGetContent("content"),o=jQuery("#fusion-custom-css-field").val(),C.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:i.data("layout_id")},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),C("body").removeClass("fusion_builder_inner_row_no_scroll"),C(".fusion_builder_modal_inner_row_overlay").remove(),C("#fusion-builder-layouts").hide()},success:function(e){var i;FusionPageBuilderApp.layoutLoaded(),i=JSON.parse(e),"above"===t?(n=i.post_content+n,void 0!==i.custom_css&&C("#fusion-custom-css-field").val(i.custom_css+"\n"+o)):"below"===t?(n+=i.post_content,void 0!==i.custom_css&&(o.length?C("#fusion-custom-css-field").val(o+"\n"+i.custom_css):C("#fusion-custom-css-field").val(i.custom_css))):(n=i.post_content,void 0!==i.custom_css&&C("#fusion-custom-css-field").val(i.custom_css),jQuery.each(i.post_meta,function(e,i){jQuery("#"+e).val(i).trigger("change")})),FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.createBuilderLayout(n),void 0!==i.page_template&&C("#page_template").val(i.page_template),FusionPageBuilderApp.layoutIsLoading=!1},complete:function(){FusionPageBuilderEvents.trigger("fusion-hide-loader")}}))},loadDemoPage:function(e){var i,t,n,o;if(e&&e.preventDefault(),!1===confirm(fusionBuilderText.importing_single_page))return!1;!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,i=C(e.currentTarget).data("page-name"),t=C(e.currentTarget).data("demo-name"),n=C(e.currentTarget).data("post-id"),C.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_load_demo",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,page_name:i,demo_name:t,post_id:n},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),C("body").removeClass("fusion_builder_inner_row_no_scroll"),C(".fusion_builder_modal_inner_row_overlay").remove(),C("#fusion-builder-layouts").hide()},success:function(e){var i,t;FusionPageBuilderApp.layoutLoaded(),i=JSON.parse(e),o=i.post_content,FusionPageBuilderApp.clearBuilderLayout(!1),FusionPageBuilderApp.createBuilderLayout(o),void 0!==i.page_template&&C("#page_template").val(i.page_template),t=i.meta,_.each(t,function(e,i){C("#"+i).val(e).trigger("change")}),FusionPageBuilderApp.layoutIsLoading=!1},complete:function(){FusionPageBuilderEvents.trigger("fusion-hide-loader")}}))},deleteLayout:function(e){var i,t,n=!1;if(e&&(e.preventDefault(),C(e.currentTarget).closest("li").hasClass("fusion-global")?(t=confirm(fusionBuilderText.are_you_sure_you_want_to_delete_global),n=!0):t=confirm(fusionBuilderText.are_you_sure_you_want_to_delete_this),!1===t))return!1;!0!==this.layoutIsDeleting&&(this.layoutIsDeleting=!0,i=C(e.currentTarget).closest("li"),C.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_delete_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:i.data("layout_id")},success:function(){var e="elements";i.parents("#fusion-builder-layouts-templates").length&&(e="templates"),i.remove(),FusionPageBuilderApp.layoutIsDeleting=!1,C("#fusion-builder-layouts-"+e+" .fusion-page-layouts").find("li").length||C("#fusion-builder-layouts-"+e+" .fusion-page-layouts .fusion-empty-library-message").show(),!0===n&&C.each(C('div[fusion-global-layout="'+i.data("layout_id")+'"]'),function(e,i){C(this).hasClass("fusion-builder-section-content")?C(this).parent().parent().find("a.fusion-builder-remove").first().trigger("click"):(C(this).find("a.fusion-builder-remove").first().trigger("click"),C(this).find("a.fusion-builder-remove-inner-row").first().trigger("click"))})}}))},openLibrary:function(e){e&&e.preventDefault(),this.showLibrary(),C("#fusion-builder-layouts-templates-trigger").click()},showLibrary:function(e){e&&e.preventDefault(),C("#fusion-builder-layouts").show(),C("body").addClass("fusion_builder_inner_row_no_scroll").append('<div class="fusion_builder_modal_inner_row_overlay"></div>')},hideLibrary:function(e){e&&e.preventDefault(),C("#fusion-builder-layouts").hide(),C("body").removeClass("fusion_builder_inner_row_no_scroll"),C(".fusion_builder_modal_inner_row_overlay").remove(),C(".fusion-save-element-fields").remove()},showLoader:function(){C("#fusion_builder_main_container").css("height","148px"),C("#fusion_builder_container").hide(),C("#fusion-loader").fadeIn("fast")},hideLoader:function(){C("#fusion_builder_container").fadeIn("fast"),C("#fusion_builder_main_container").removeAttr("style"),C("#fusion-loader").fadeOut("fast")},sortableContainers:function(){this.$el.sortable({handle:".fusion-builder-section-header",items:".fusion_builder_container, .fusion-builder-next-page",cancel:".fusion-builder-section-name, .fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-element",cursor:"move",update:function(){fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.moved_container,FusionPageBuilderEvents.trigger("fusion-element-sorted")}})},initialBuilderLayout:function(e){FusionPageBuilderViewManager.removeViews(),FusionPageBuilderEvents.trigger("fusion-show-loader"),setTimeout(function(){var i=fusionBuilderGetContent("content",!0,e),t="",n="",o="";try{jQuery("body").hasClass("fusion-builder-library-edit")||(i=FusionPageBuilderApp.validateContent(i)),FusionPageBuilderApp.createBuilderLayout(i),FusionPageBuilderEvents.trigger("fusion-hide-loader")}catch(e){FusionPageBuilderApp.fusionBuilderSetContent("content",i),jQuery("#fusion_toggle_builder").trigger("click"),t=FusionPageBuilderApp.$el.find("#content-error"),n=FusionPageBuilderApp.$el,o=t.clone(),t.dialog({dialogClass:"fusion-builder-dialog",autoOpen:!1,modal:!0,buttons:{OK:function(){jQuery(this).dialog("close")}},close:function(){n.append(o)}}),t.dialog("open")}},50)},validateContent:function(t){var n,i,o,e=""===t,a="",l=[],s=[];if(-1!==t.indexOf("[fullwidth"))throw"Avada 4.0.3 or earlier fullwidth container used!";return e||(t=(t=t.replace(/\[fusion\_text \/\]/g,"[fusion_text][/fusion_text]").replace(/\[\/fusion\_text\]\[\/fusion\_text\]/g,"[/fusion_text]")).replace(/\$\$/g,"&#36;&#36;"),a=t,a=wp.shortcode.replace("fusion_builder_container",a,function(){return"@|@"}),a=(a=wp.shortcode.replace("fusion_builder_next_page",a,function(){return"@|@"})).trim().split("@|@"),_.each(a,function(e){""!==e.trim()&&(t=t.replace(e,'[fusion_builder_container hundred_percent="no" equal_height_columns="no" menu_anchor="" hide_on_mobile="small-visibility,medium-visibility,large-visibility" class="" id="" background_color="" background_image="" background_position="center center" background_repeat="no-repeat" fade="no" background_parallax="none" parallax_speed="0.3" video_mp4="" video_webm="" video_ogv="" video_url="" video_aspect_ratio="16:9" video_loop="yes" video_mute="yes" overlay_color="" overlay_opacity="0.5" video_preview_image="" border_size="" border_color="" border_style="solid" padding_top="" padding_bottom="" padding_left="" padding_right=""][fusion_builder_row]'+e+"[/fusion_builder_row][/fusion_builder_container]"))}),a=wp.shortcode.replace("fusion_builder_container",t,function(e){s.push(e.content)}),_.each(s,function(e){e=wp.shortcode.replace("fusion_builder_row",e,function(e){return e.content}),e=(e=wp.shortcode.replace("fusion_builder_column",e,function(){return"@|@"})).trim().split("@|@"),_.each(e,function(e){""!==e.trim()&&"[fusion_builder_row][/fusion_builder_row]"!==e.trim()&&(i='[fusion_builder_column type="1_1" background_position="left top" background_color="" border_size="" border_color="" border_style="solid" border_position="all" spacing="yes" background_image="" background_repeat="no-repeat" padding="" margin_top="0px" margin_bottom="0px" class="" id="" animation_type="" animation_speed="0.3" animation_direction="left" hide_on_mobile="small-visibility,medium-visibility,large-visibility" center_content="no" last="no" min_height="" hover_type="none" link=""]'+e+"[/fusion_builder_column]",t=t.replace(e,i))})}),a=wp.shortcode.replace("fusion_builder_column_inner",t,function(e){l.push(e.content)}),a=wp.shortcode.replace("fusion_builder_column",t,function(e){l.push(e.content)}),_.each(l,function(i){n=fusionAllElements,_.each(n,function(e){void 0===e.generator_only&&(i=wp.shortcode.replace(e.shortcode,i,function(){return"@|@"}))}),i=i.trim().split("@|@"),_.each(i,function(e){""!==e.trim()&&"<br />"!==e.trim()&&(o="@=%~@","@"===e.slice(-1)&&(o="#=%~#"),t=t.replace(e,"[fusion_text]"+e.slice(0,-1)+o+e.slice(-1)+"[/fusion_text]"))})}),t=t.replace(/@=%~@/g,"").replace(/#=%~#/g,""),t=wp.shortcode.replace("fusion_text",t,function(e){if(n=fusionAllElements,a=e.content,_.each(n,function(e){void 0===e.generator_only&&(a=wp.shortcode.replace(e.shortcode,a,function(){return"|"}))}),!a.replace(/\|/g,"").length)return e.content})),t=t.replace(/&#36;&#36;/g,function(){return"$$"})},validateLibraryContent:function(e){var i='[fusion_builder_container hundred_percent="no" equal_height_columns="no" menu_anchor="" hide_on_mobile="small-visibility,medium-visibility,large-visibility" class="" id="" background_color="" background_image="" background_position="center center" background_repeat="no-repeat" fade="no" background_parallax="none" parallax_speed="0.3" video_mp4="" video_webm="" video_ogv="" video_url="" video_aspect_ratio="16:9" video_loop="yes" video_mute="yes" overlay_color="" overlay_opacity="0.5" video_preview_image="" border_size="" border_color="" border_style="solid" padding_top="" padding_bottom="" padding_left="" padding_right=""][fusion_builder_row]',t="[/fusion_builder_row][/fusion_builder_container]";return""===e||(jQuery("body").hasClass("fusion-element-post-type-elements")?e=i+'[fusion_builder_column type="1_1" background_position="left top" background_color="" border_size="" border_color="" border_style="solid" border_position="all" spacing="yes" background_image="" background_repeat="no-repeat" padding="" margin_top="0px" margin_bottom="0px" class="" id="" animation_type="" animation_speed="0.3" animation_direction="left" hide_on_mobile="small-visibility,medium-visibility,large-visibility" center_content="no" last="no" min_height="" hover_type="none" link=""]'+e+"[/fusion_builder_column]"+t:jQuery("body").hasClass("fusion-element-post-type-columns")&&(e=i+e+t)),e=e.replace(/&#36;&#36;/g,function(){return"$$"})},clearBuilderLayout:function(e){this.$el.find(".fusion-builder-blank-page-content").each(function(){var e=C(this),i=FusionPageBuilderViewManager.getView(e.data("cid"));void 0!==i&&i.removeBlankPageHelper()}),this.$el.find(".fusion-builder-section-content").each(function(){var e=C(this),i=FusionPageBuilderViewManager.getView(e.data("cid"));void 0!==i&&i.removeContainer()}),e&&!0===this.blankPage&&(this.$el.find(".fusion-builder-blank-page-content").length||this.createBuilderLayout("[fusion_builder_blank_page][/fusion_builder_blank_page]"),this.blankPage=!1)},convertGalleryElement:function(e){var i=window.wp.shortcode.regexp("fusion_gallery"),l=this.regExpShortcode("fusion_gallery"),t=e.match(i),s=e,r=[];return _.each(t,function(e){var i,t=e.match(l),n=""!==t[3]?window.wp.shortcode.attrs(t[3]):"",o="",a="";void 0!==n.named.image_ids&&(i=n.named.image_ids.split(","),_.each(i,function(e){o+='[fusion_gallery_image image="" image_id="'+e+'" /]',r.push(e)}),a=e.replace("][/fusion_gallery]","]"+o+"[/fusion_gallery]").replace("/]","]"+o+"[/fusion_gallery]").replace('image_ids="'+n.named.image_ids+'" ',""),s=s.replace(e,a))}),wp.media.query({post__in:r,posts_per_page:r.length}).more(),s},createBuilderLayout:function(e){jQuery("body").hasClass("fusion-builder-library-edit")&&(e=FusionPageBuilderApp.validateLibraryContent(e)),e=this.convertGalleryElement(e),this.shortcodesToBuilder(e),jQuery("body").hasClass("fusion-builder-library-edit")?this.libraryBuilderToShortcodes():this.builderToShortcodes()},shortcodesToBuilder:function(e,h,b,v){var y,w,B,i,t;""!==e||this.$el.find(".fusion-builder-blank-page-content").length?(y=this,t=_.keys(fusionAllElements).join("|"),w=window.wp.shortcode.regexp(t),B=this.regExpShortcode(t),i=e.match(w),_.each(i,function(e){var i,t,n,o,a,l,s,r,u=e.match(B),d=u[2],c=""!==u[3]?window.wp.shortcode.attrs(u[3]):"",f=void 0!==u[5]?u[5]:"",m=FusionPageBuilderViewManager.generateCid(),g={params:{}},p=void 0!==f&&""!==f&&f.match(w);if(i={type:d,element_type:d,cid:m,created:"manually",multi:"",params:{},allow_generator:void 0!==fusionAllElements[d].allow_generator?fusionAllElements[d].allow_generator:""},"fusion_builder_container"===d&&"fusion_builder_next_page"===d||(i.parent=h),"fusion_builder_container"!==d&&"fusion_builder_row"!==d&&"fusion_builder_column"!==d&&"fusion_builder_column_inner"!==d&&"fusion_builder_row_inner"!==d&&"fusion_builder_blank_page"!==d&&"fusion_builder_next_page"!==d&&(-1===d.indexOf("fusion_")&&-1===d.indexOf("layerslider")&&-1===d.indexOf("rev_slider")&&void 0===fusionAllElements[d]||(i.type="element")),_.isObject(c.named)){for(t in c.named)n=t,"fusion_builder_column"!==d&&"fusion_builder_column_inner"!==d||"type"!==n||(g[n="layout"]=c.named[t]),g.params[n]=c.named[t],"fusion_products_slider"===d&&"cat_slug"===t&&(g.params.cat_slug=c.named[t].replace(/\|/g,",")),"gradient_colors"===t&&(delete g.params[n],-1!==c.named[t].indexOf("|")?(g.params.button_gradient_top_color=c.named[t].split("|")[0].replace("transparent","rgba(255,255,255,0)"),g.params.button_gradient_bottom_color=c.named[t].split("|")[1]?c.named[t].split("|")[1].replace("transparent","rgba(255,255,255,0)"):c.named[t].split("|")[0].replace("transparent","rgba(255,255,255,0)")):g.params.button_gradient_bottom_color=g.params.button_gradient_top_color=c.named[t].replace("transparent","rgba(255,255,255,0)")),"gradient_hover_colors"===t&&(delete g.params[n],-1!==c.named[t].indexOf("|")?(g.params.button_gradient_top_color_hover=c.named[t].split("|")[0].replace("transparent","rgba(255,255,255,0)"),g.params.button_gradient_bottom_color_hover=c.named[t].split("|")[1]?c.named[t].split("|")[1].replace("transparent","rgba(255,255,255,0)"):c.named[t].split("|")[0].replace("transparent","rgba(255,255,255,0)")):g.params.button_gradient_bottom_color_hover=g.params.button_gradient_top_color_hover=c.named[t].replace("transparent","rgba(255,255,255,0)")),"overlay_color"===t&&""!==c.named[t]&&"fusion_builder_container"===d&&(delete g.params[n],s=void 0!==c.named.overlay_opacity?c.named.overlay_opacity:1,g.params.background_color=jQuery.Color(c.named[t]).alpha(s).toRgbaString()),"overlay_opacity"===t&&delete g.params[n],"scrolling"===t&&"fusion_blog"===d&&(delete g.params.paging,"no"===(void 0!==c.named.paging?c.named.paging:"")&&"pagination"===c.named.scrolling&&(g.params.scrolling="no")),"fusion_portfolio"===d&&("layout"===t&&("grid"===c.named[t]&&c.named.hasOwnProperty("boxed_text")?c.named.boxed_text="no_text":"grid-with-text"===c.named[t]&&(g.params[t]="grid")),"boxed_text"===t&&(g.params.text_layout=c.named[t],delete g.params[t]),"content_length"===t&&"full-content"===c.named[t]&&(g.params[t]="full_content")),"fusion_pricing_table"===d&&("backgroundcolor"!==t||c.named.hasOwnProperty("background_color_hover")||(g.params.background_color_hover=c.named.bordercolor)),"padding"!==t||"fusion_widget_area"!==d&&"fusion_builder_column"!==d&&"fusion_builder_column_inner"!==d||(1===(r=c.named[t].split(" ")).length&&(g.params.padding_top=r[0],g.params.padding_right=r[0],g.params.padding_bottom=r[0],g.params.padding_left=r[0]),2===r.length&&(g.params.padding_top=r[0],g.params.padding_right=r[1],g.params.padding_bottom=r[0],g.params.padding_left=r[1]),3===r.length&&(g.params.padding_top=r[0],g.params.padding_right=r[1],g.params.padding_bottom=r[2],g.params.padding_left=r[1]),4===r.length&&(g.params.padding_top=r[0],g.params.padding_right=r[1],g.params.padding_bottom=r[2],g.params.padding_left=r[3]),delete g.params[t]);"fusion_table"===d&&void 0===c.named.fusion_table_type&&("1"!==f.charAt(18)&&"2"!==f.charAt(18)||(g.params.fusion_table_type=f.charAt(18))),"fusion_content_boxes"===d&&void 0!==c.named.image_width&&(g.params.image_max_width=c.named.image_width,f=f.replace(/image_width/g,"image_max_width")),"fusion_register"===d&&void 0===c.named.register_note&&(g.params.register_note=fusionBuilderText.user_login_register_note),i=_.extend(i,g)}p||"fusion_builder_column"===d||(i.params.element_content=f),d in fusionMultiElements&&(i.multi="multi_element_parent"),void 0!==fusionAllElements[d].option_dependency&&(o=fusionAllElements[d].option_dependency,a=g.params[o],l=g.params.element_content,g.params[a]=l),p&&"fusion_builder_container"!==d&&"fusion_builder_row"!==d&&"fusion_builder_row_inner"!==d&&"fusion_builder_column"!==d&&"fusion_builder_column_inner"!==d&&"fusion_builder_next_page"!==d&&(i.params.element_content=f),void 0!==b&&b&&(i.targetElement=b),void 0!==v&&v&&(i.targetElementPosition=v),y.collection.add([i]),p&&("fusion_builder_container"!==d&&"fusion_builder_row"!==d&&"fusion_builder_row_inner"!==d&&"fusion_builder_column"!==d&&"fusion_builder_column_inner"!==d||y.shortcodesToBuilder(f,m))})):this.createBuilderLayout("[fusion_builder_blank_page][/fusion_builder_blank_page]")},addBuilderElement:function(i){var e,t,n,o,a={model:i,collection:FusionPageBuilderElements};switch(i.get("type")){case"fusion_builder_blank_page":e=new FusionPageBuilder.BlankPageView(a),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("view"))?this.$el.find("#fusion_builder_container").append(e.render().el):i.get("view").$el.after(e.render().el);break;case"fusion_builder_container":""!==FusionPageBuilderApp.targetContainerCID&&(i.attributes.view=FusionPageBuilderViewManager.getView(FusionPageBuilderApp.targetContainerCID),FusionPageBuilderApp.targetContainerCID=""),e=new FusionPageBuilder.ContainerView(a),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("view"))?(this.$el.find("#fusion_builder_container").append(e.render().el),this.$el.find(".fusion_builder_blank_page").remove()):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("view").$el.after(e.render().el):i.get("view").$el.before(e.render().el),"manually"!==i.get("created")&&e.addRow(),(!_.isUndefined(i.attributes.params.admin_toggled)&&"no"===i.attributes.params.admin_toggled||_.isUndefined(i.attributes.params.admin_toggled))&&(FusionPageBuilderApp.toggledContainers=!1,C(".fusion-builder-layout-buttons-toggle-containers").find("span").addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down"));break;case"fusion_builder_row":e=new FusionPageBuilder.RowView(a),FusionPageBuilderViewManager.addView(i.get("cid"),e),FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").length?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").append(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find("> .fusion-builder-add-element").hide().end().append(e.render().el),"manually"===i.get("created")&&"row_inner"===i.get("element_type")&&i.set("view",FusionPageBuilderViewManager.getView(i.get("parent")),{silent:!0});break;case"fusion_builder_row_inner":FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),e=new FusionPageBuilder.InnerRowView(a),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("appendAfter"))?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").length?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").append(e.render().el):_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find("> .fusion-builder-add-element").before(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find("> .fusion-builder-column-controls").after(e.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(e.render().el):i.get("targetElement").before(e.render().el):(i.get("appendAfter").after(e.render().el),i.unset("appendAfter")),"manually"===i.get("created")&&"row_inner"===i.get("element_type")&&i.set("view",FusionPageBuilderViewManager.getView(i.get("parent")),{silent:!0});break;case"fusion_builder_column":i.get("layout")&&(a.className="fusion-builder-column fusion-builder-column-outer fusion-builder-column-"+i.get("layout"),e=new FusionPageBuilder.ColumnView(a),_.isUndefined(i.get("cloned"))||!0!==i.get("cloned")||(i.targetElement=e.$el,i.unset("cloned")),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?(void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container").append(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container .fusion-builder-empty-section").after(e.render().el),i.unset("from")):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(e.render().el):i.get("targetElement").before(e.render().el));break;case"fusion_builder_column_inner":a.className="fusion-builder-column fusion-builder-column-inner fusion-builder-column-"+i.get("layout"),e=new FusionPageBuilder.NestedColumnView(a),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container-inner").append(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container-inner").prepend(e.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(e.render().el):i.get("targetElement").before(e.render().el);break;case"element":a.attributes={"data-cid":i.get("cid")},void 0!==i.get("multi")&&"multi_element_child"===i.get("multi")?(e=new FusionPageBuilder.MultiElementSortableChild(a),i.targetElement=e.$el,i.attributes.view.child_views.push(e),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("targetElement"))?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-sortable-options").append(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-sortable-options").prepend(e.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(e.render().el):i.get("targetElement").before(e.render().el),_.isUndefined(i.get("titleLabel"))||(_.isUndefined(i.get("cloned"))||e.$el.find(".multi-element-child-name").html(i.get("titleLabel")),i.unset("cloned"))):(FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),e=new FusionPageBuilder.ElementView(a),void 0!==(t=this.collection.find(function(e){return e.get("cid")===i.get("parent")}))&&"fusion_builder_column_inner"===t.get("type")?_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-add-element").before(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.prepend(e.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(e.render().el):i.get("targetElement").before(e.render().el):_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-add-element:not(.fusion-builder-column-inner .fusion-builder-add-element)").before(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.prepend(e.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(e.render().el):i.get("targetElement").before(e.render().el),FusionPageBuilderViewManager.addView(i.get("cid"),e),"manually"===i.get("added")?(a.attributes={"data-modal_view":"element_settings"},e=new FusionPageBuilder.ModalView(a),C("body").append(e.render().el)):(n=i.get("element_type"),void 0!==fusionAllElements[n].preview&&(o=new FusionPageBuilder.ElementPreviewView(a),e.$el.find(".fusion-builder-module-preview").append(o.render().el))));break;case"generated_element":FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),"fusion_builder_column_inner"!==i.get("element_type")&&"fusion_builder_column"!==i.get("element_type")&&(a.attributes={"data-modal_view":"element_settings"},e=new FusionPageBuilder.ModalView(a),C("body").append(e.render().el));break;case"fusion_builder_next_page":e=new FusionPageBuilder.NextPage(a),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("appendAfter"))?C(".fusion_builder_container:last-child").after(e.render().el):i.get("appendAfter").next().next().hasClass("fusion-builder-next-page")||i.get("appendAfter").after(e.render().el)}},regExpShortcode:_.memoize(function(e){return new RegExp("\\[(\\[?)("+e+")(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)(\\[\\/\\2\\]))?)(\\]?)")}),findShortcodeMatches:function(e,i){var t,n;return _.isObject(e)&&(e=e.value),t="",e=void 0!==e?e:"",n=window.wp.shortcode.regexp(i),new RegExp("\\[(\\[?)("+i+")(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)(\\[\\/\\2\\]))?)(\\]?)"),void 0!==e&&""!==e&&(t=e.match(n)),t},libraryBuilderToShortcodes:function(){var e,i,t="";jQuery("body").hasClass("fusion-element-post-type-elements")?jQuery(".fusion-builder-column-outer .fusion_builder_row_inner").length?(e=jQuery(".fusion-builder-column-outer .fusion_builder_row_inner").data("cid"),i=FusionPageBuilderViewManager.getView(e),t=i.getInnerRowContent()):jQuery(".fusion_module_block").length&&(t=FusionPageBuilderApp.generateElementShortcode(jQuery(".fusion_module_block"),!1)):jQuery("body").hasClass("fusion-element-post-type-columns")?jQuery(".fusion-builder-column-outer").length&&(e=jQuery(".fusion-builder-column-outer").data("cid"),i=FusionPageBuilderViewManager.getView(e),t=i.getColumnContent(jQuery(".fusion-builder-column-outer"))):jQuery("body").hasClass("fusion-element-post-type-sections")&&jQuery(".fusion-builder-section-content").length&&(e=jQuery(".fusion-builder-section-content.fusion-builder-data-cid").data("cid"),i=FusionPageBuilderViewManager.getView(e),t=i.getContainerContent()),setTimeout(function(){FusionPageBuilderApp.fusionBuilderSetContent("content",t),FusionPageBuilderEvents.trigger("fusion-save-history-state")},500)},builderToShortcodes:function(){var n="",i=this;jQuery("body").hasClass("fusion-builder-library-edit")?this.libraryBuilderToShortcodes():"undefined"===this.pauseBuilder||this.pauseBuilder||(this.$el.find(".fusion_builder_container").each(function(){var e=C(this).find(".fusion-builder-section-content");n+=i.generateElementShortcode(C(this),!0),e.find(".fusion_builder_row").each(function(){var e=C(this);n+="[fusion_builder_row]",e.find(".fusion-builder-column-outer").each(function(){var e=C(this),i=e.data("cid"),t=FusionPageBuilderViewManager.getView(i);n+=t.getColumnContent(e)}),n+="[/fusion_builder_row]"}),n+="[/fusion_builder_container]",C(this).next().hasClass("fusion-builder-next-page")&&(n+="[fusion_builder_next_page]")}),setTimeout(function(){FusionPageBuilderApp.fusionBuilderSetContent("content",n),FusionPageBuilderEvents.trigger("fusion-save-history-state")},500))},syncGlobalLayouts:function(){var i,t,n=C("#fusion_builder_main_container"),o=!1,a=[];0!==n.find('div[class^="fusion-global-"],div[class*=" fusion-global-"]').length&&C('div[class^="fusion-global-"],div[class*=" fusion-global-"]').each(function(){var e=C(this).attr("fusion-global-layout");1<n.find('[fusion-global-layout="'+e+'"]').length&&C('[fusion-global-layout="'+e+'"]').each(function(){o=!1,C(this).hasClass("fusion-global-container")?o=FusionPageBuilderApp.isChildElementChanged(C(this),"container"):C(this).hasClass("fusion-global-column")&&(o=FusionPageBuilderApp.isChildElementChanged(C(this),"column")),i=void 0===C(this).data("cid")?C(this).find(".fusion-builder-data-cid").data("cid"):C(this).data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),(0<_.keys(t.changed).length||!0===o)&&-1===C.inArray(e,a)&&(FusionPageBuilderApp.updateGlobalLayouts(this,t,e),a.push(e))})})},isChildElementChanged:function(e,i){var a,t,l=!1;if("container"===i)e.find(".fusion-builder-row-content:not(.fusion_builder_row_inner .fusion-builder-row-content)").each(function(){var e,i=C(this),t=i.data("cid");if(e=FusionPageBuilderElements.find(function(e){return e.get("cid")===t}),0<_.keys(e.changed).length)return!(l=!0);i.find(".fusion-builder-column-outer").each(function(){var e=C(this),o=e.data("cid"),i=FusionPageBuilderElements.find(function(e){return e.get("cid")===o});if(0<_.keys(i.changed).length)return!(l=!0);e.children(".fusion_module_block, .fusion_builder_row_inner").each(function(){var e,i,t,n;if(C(this).hasClass("fusion_module_block")){if(e=C(this),i=e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),0<_.keys(t.changed).length)return!(l=!0)}else C(this).hasClass("fusion_builder_row_inner")&&(n=C(this).data("cid"),void 0!==FusionPageBuilderViewManager.getView(n)&&(l=FusionPageBuilderApp.isNestedRowChanged("",o)))})})});else if("column"===i){if("",a=e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===a}),0<_.keys(t.changed).length)return!(l=!0);e.find(".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)").each(function(){var e,i,t,n,o;if(C(this).hasClass("fusion_module_block")){if(e=C(this),i=void 0===e.data("cid")?e.find(".fusion-builder-data-cid").data("cid"):e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),0<_.keys(t.changed).length)return!(l=!0)}else C(this).hasClass("fusion_builder_row_inner")&&(o=void 0===(n=C(this)).data("cid")?n.find(".fusion-builder-data-cid").data("cid"):n.data("cid"),void 0!==FusionPageBuilderViewManager.getView(o)&&(l=FusionPageBuilderApp.isNestedRowChanged("",a)))})}return l},isNestedRowChanged:function(e){var n;return e&&e.preventDefault(),0<_.keys(this.model.changed).length?!(n=!0):(this.$el.find(".fusion-builder-column-inner").each(function(){var e=C(this),i=e.data("cid"),t=FusionPageBuilderElements.findWhere({cid:i});if(0<_.keys(t.changed).length)return!(n=!0);e.find(".fusion_module_block").each(function(){var e=C(this),i=void 0===e.data("cid")?e.find(".fusion-builder-data-cid").data("cid"):e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i});if(0<_.keys(t.changed).length)return!(n=!0)})}),n)},checkGlobalParents:function(i){var e,t=C("#fusion_builder_main_container");module=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),"undefined"!=typeof module&&(void 0!==module.attributes.params&&void 0!==module.attributes.params.fusion_global&&1<t.find('[fusion-global-layout="'+module.attributes.params.fusion_global+'"]').length&&void 0!==(e=FusionPageBuilderViewManager.getView(module.get("cid")))&&FusionPageBuilderApp.updateGlobalLayouts(e.$el,module,module.attributes.params.fusion_global),void 0!==module.attributes.params&&void 0!==module.get("parent")&&FusionPageBuilderApp.checkGlobalParents(module.get("parent")))},updateGlobalLayouts:function(e,i,t){var n,o,a,l,s=C(e),r="";C(e).hasClass("fusion_builder_column_element")&&!C(e).hasClass("fusion_builder_row_inner")?r+=FusionPageBuilderApp.generateElementShortcode(C(e),!1):C(e).hasClass("fusion_builder_row_inner")?(a=s.data("cid"),l=FusionPageBuilderViewManager.getView(a),r+=l.getInnerRowContent(s)):C(e).hasClass("fusion-builder-column")?(n=C(e).data("cid"),o=FusionPageBuilderViewManager.getView(n),r+=o.getColumnContent(C(e))):C(e).hasClass("fusion_builder_container")&&(r+=FusionPageBuilderApp.generateElementShortcode(C(e),!0),s.find(".fusion_builder_row").each(function(){var e=C(this);r+="[fusion_builder_row]",e.find(".fusion-builder-column-outer").each(function(){var e=C(this),i=e.data("cid"),t=FusionPageBuilderViewManager.getView(i);r+=t.getColumnContent(e)}),r+="[/fusion_builder_row]"}),r+="[/fusion_builder_container]"),C.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_update_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:t,fusion_layout_content:r},complete:function(){}})},saveHistoryState:function(){!0===this.newLayoutLoaded&&(fusionHistoryManager.clearEditor(),this.newLayoutLoaded=!1),fusionHistoryManager.captureEditor(),fusionHistoryManager.turnOffTracking()},generateElementShortcode:function(e,i,t){var n,o,a,l,s,r,u,d,c,f,m,g,p,h,_,b,v,y,w,B,P="",F="";for(f in l=void 0!==(n=!0===t?e:(a=void 0===(o=e).data("cid")?o.find(".fusion-builder-data-cid").data("cid"):o.data("cid"),FusionPageBuilderElements.find(function(e){return e.get("cid")===a})))?n.get("element_type"):"undefined",r="",s=n.attributes,(u=void 0!==fusionAllElements[l].remove_from_atts?fusionAllElements[l].remove_from_atts:[]).push("undefined"),d=void 0!==fusionAllElements[l].option_dependency?fusionAllElements[l].option_dependency:"",s)if("params"===(g=f))if(p=void 0!==n.get(g)?n.get(g):"","params"===g)for(h in p)"element_content"===(_=h)?(F=b=void 0!==p[h]?p[h]:"",void 0!==p[d]&&""!==d&&(F=void 0!==p[c=void 0!==p[d=fusionAllElements[l].option_dependency]?p[d]:""]?p[c]:"")):((v="")!==d&&(m=_,c=void 0!==p[d]?p[d]:"",void 0!==fusionAllElements[l].params[m]&&void 0!==fusionAllElements[l].params[m].dependency&&(w=void 0!==(y=fusionAllElements[l].params[m].dependency).element?y.element:"",B=void 0!==y.value?y.value:"",w===d&&B!==c&&(v="",v=m))),-1<C.inArray(h,u)||v===h||(null===(b=void 0!==p[h]?p[h]:"")&&(b=""),P+=" "+h+'="'+b+'"'));else""!==p&&(P+=" "+g+'="'+p+'"');return r="["+l+P,""===F&&"fusion_tab"!==l&&"fusion_text"!==l&&"fusion_code"!==l&&void 0!==s.type&&"element"===s.type?(i=!0,r+=" /]"):r+="]",i||(r+=F+"[/"+l+"]"),r},customCSS:function(e){e&&e.preventDefault(),C(".fusion-custom-css").slideToggle()},toggleAllContainers:function(e){var i,t,n=this;e&&e.preventDefault(),(i=C(".fusion-builder-layout-buttons-toggle-containers").find("span")).hasClass("dashicons-arrow-up")?(i.removeClass("dashicons-arrow-up").addClass("dashicons-arrow-down"),jQuery(".fusion_builder_container").each(function(){t=jQuery(this).find(".fusion-builder-data-cid").data("cid"),n.collection.find(function(e){return e.get("cid")===t}).attributes.params.admin_toggled="yes",jQuery(this).addClass("fusion-builder-section-folded"),jQuery(this).find(".fusion-builder-toggle > span").removeClass("dashicons-arrow-up").addClass("dashicons-arrow-down")})):(i.addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down"),jQuery(".fusion_builder_container").each(function(){t=jQuery(this).find(".fusion-builder-data-cid").data("cid"),n.collection.find(function(e){return e.get("cid")===t}).attributes.params.admin_toggled="no",jQuery(this).removeClass("fusion-builder-section-folded"),jQuery(this).find(".fusion-builder-toggle > span").addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down")})),FusionPageBuilderEvents.trigger("fusion-element-edited")},showSavedElements:function(e,i){var t,n=jQuery("#fusion-builder-layouts-"+e).find(".fusion-page-layouts").clone();n.find("li").each(function(){t=jQuery(this).find(".fusion-builder-demo-button-load").attr("data-post-id"),jQuery(this).find(".fusion-layout-buttons").remove(),jQuery(this).find("h4").attr("class","fusion_module_title"),jQuery(this).attr("data-layout_id",t),jQuery(this).addClass("fusion_builder_custom_"+e+"_load"),""!==jQuery(this).attr("data-layout_type")&&jQuery(this).addClass("fusion-element-type-"+jQuery(this).attr("data-layout_type"))}),i.append('<div id="fusion-loader"><span class="fusion-builder-loader"></span></div>'),i.append('<ul class="fusion-builder-all-modules">'+n.html()+"</div>")},rangeOptionPreview:function(e){e.find(".fusion-range-option").each(function(){C(this).next().html(C(this).val()),C(this).on("change mousemove",function(){C(this).next().html(C(this).val())})})},addClassToElement:function(e,i,t,n){var o=fusionBuilderText.global_element;e.addClass(i),e.attr("fusion-global-layout",t),"fusion-global-column"===i?o=fusionBuilderText.global_column:"fusion-global-container"===i&&(o=fusionBuilderText.global_container),e.find(".fusion-builder-container-utility-toolbar").length?e.find(".fusion-builder-container-utility-toolbar").append('<div class="fusion-builder-global-tooltip" data-cid="'+n+'"><span>'+o+"</span></div>"):e.append('<div class="fusion-builder-global-tooltip" data-cid="'+n+'"><span>'+o+"</span></div>")},checkOptionDependency:function(e,n,o,a,t){var l,i,s,r,u,d,c,f,m={},g="",p="",h=e.params;function _(e,i,t){return"=="===t&&e==i||("!="===t&&e!=i||(">"===t&&i<e||"<"===t&&e<i))}void 0!==a&&(h=a),void 0!==e.shortcode&&"fusion_section_separator"===e.shortcode&&(u=n.find("#divider_type"),d=u.parents("ul").find('li[data-option-id="divider_candy"]').find(".fusion-option-divider_candy").find('.ui-button[data-value="bottom,top"]'),c=u.parents("ul").find('li[data-option-id="divider_position"]').find(".fusion-option-divider_position").find('.ui-button[data-value="center"]'),"triangle"!==u.val()?d.hide():d.show(),"bigtriangle"!==u.val()?c.hide():c.show(),u.on("change paste keyup",function(){"triangle"!==jQuery(this).val()?d.hide():d.show(),"bigtriangle"!==jQuery(this).val()?(c.hide(),c.hasClass("ui-state-active")&&c.prev().click()):c.show()})),jQuery.each(h,function(e,t){void 0!==t.dependency&&(s=e,r=[],jQuery.each(t.dependency,function(e,i){void 0!==a&&"parent_"===i.element.substring(0,7)&&p.indexOf("#"+i.element.replace("parent_",""))<0?p+=", #"+i.element.replace("parent_",""):g.indexOf("#"+i.element)<0&&(g+=", #"+i.element),void 0===m[i.element]?m[i.element]=[{option:s,or:t.or}]:m[i.element].push({option:s,or:t.or}),l="parent_"===i.element.substring(0,7)?void 0!==a?n.parents(".fusion-builder-main-settings").find("#"+i.element.replace("parent_","")).val():"object"==typeof o&&o[i.element.replace(i.element.substring(0,7),"")]?o[i.element.replace(i.element.substring(0,7),"")]:"":n.find("#"+i.element).val(),r.push(_(l,i.value,i.operator))}),f=n.find("#"+e).parents(".fusion-builder-option").first(),-1===C.inArray(!1,r)&&void 0===t.or?f.fadeIn(300):-1!==C.inArray(!0,r)&&void 0!==t.or?f.fadeIn(300):f.hide())}),g.length&&n.on("change paste keyup",g.substring(2),function(){i=jQuery(this).attr("id"),jQuery.each(m[i],function(e,i){r=[],jQuery.each(h[i.option].dependency,function(e,i){l="parent_"===i.element.substring(0,7)?"object"==typeof o&&o[i.element.replace(i.element.substring(0,7),"")]?o[i.element.replace(i.element.substring(0,7),"")]:"":n.find("#"+i.element).val(),r.push(_(l,i.value,i.operator))}),f=n.find("#"+i.option).parents(".fusion-builder-option").first(),-1===C.inArray(!1,r)&&void 0===i.or?f.fadeIn(300):-1!==C.inArray(!0,r)&&void 0!==i.or?f.fadeIn(300):f.hide()})}),void 0!==a&&void 0!==t&&p.length&&t.on("change paste keyup",p.substring(2),function(){i=jQuery(this).attr("id"),jQuery.each(m["parent_"+i],function(e,i){r=[],jQuery.each(h[i.option].dependency,function(e,i){l="parent_"===i.element.substring(0,7)?t.find("#"+i.element.replace("parent_","")).val():t.find("#"+i.element).val(),r.push(_(l,i.value,i.operator))}),f=n.find("#"+i.option).parents(".fusion-builder-option").first(),-1===C.inArray(!1,r)&&void 0===i.or?f.fadeIn(300):-1!==C.inArray(!0,r)&&void 0!==i.or?f.fadeIn(300):f.hide()})})}}),FusionPageBuilderApp=new FusionPageBuilder.AppView({model:FusionPageBuilder.Element,collection:FusionPageBuilderElements}),t=C("#fusion_use_builder"),n=C("#fusion_toggle_builder"),o=C("#fusion_builder_layout"),a=C("#fusion_main_editor_wrap"),n.hasClass("fusion_builder_is_active")&&(o.show(),FusionPageBuilderApp.builderActive=!0,d(),jQuery("body").addClass("fusion-builder-enabled")),n.click(function(e){e&&e.preventDefault(),C(this).hasClass("fusion_builder_is_active")?(function(){var e,i;c(),e=C("body"),0,window.wpActiveEditor="content",t.val("off"),o.hide(),n.children("span").text(n.data("builder")),n.toggleClass("fusion_builder_is_active").toggleClass("button-primary").toggleClass("fusiona-FB_logo_black"),a.toggleClass("fusion_builder_hidden"),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),i=e.scrollTop(),jQuery("html, body").scrollTop(i+1)}(C(this)),FusionPageBuilderApp.builderActive=!1,jQuery("body").removeClass("fusion-builder-enabled"),jQuery("body").trigger("scroll")):(function(e){c(),FusionPageBuilderApp.initialBuilderLayout(),t.val("active"),o.show(),e.children("span").text(e.data("editor")),e.toggleClass("fusion_builder_is_active").toggleClass("button-primary").toggleClass("fusiona-FB_logo_black"),a.toggleClass("fusion_builder_hidden"),d()}(C(this)),FusionPageBuilderApp.builderActive=!0,jQuery("body").addClass("fusion-builder-enabled"))}),jQuery("#fusion_toggle_front_end").on("click",function(e){var i=jQuery("#title"),t=jQuery(this);e.preventDefault(),window.confirm(fusionBuilderText.front_end_redirect_confirm)&&(i.val()||i.val("FB #"+jQuery("#post_ID").val()),wp.autosave&&wp.autosave.server.triggerSave(),jQuery(document).on("heartbeat-tick.autosave",function(){jQuery(window).off("beforeunload.edit-post"),window.location=t.attr("href")}))}),C("body").on("click",".upload-image-remove",function(e){var i,t,n,o;e&&e.preventDefault(),i=C(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-field"),t=C(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-preview"),n=C(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-button"),i.val("").trigger("change"),n.val("Upload Image"),t.remove(),o=n.parents(".fusion-builder-option").next().find("#"+n.data("param")+"_id"),"element_content"===n.data("param")&&(o=n.parents(".fusion-builder-option").next().find("#image_id")),o.length&&o.val(""),jQuery(this).remove()}),C(".fusion-builder-history-list li").live("click",function(e){var i;e&&e.preventDefault(),i=C(e.currentTarget).data("state-id"),fusionHistoryManager.historyStep(i)}),C(".fusion-tabs-menu a").live("click",function(e){var i;e&&e.preventDefault(),FusionPageBuilderEvents.trigger("fusion-switch-element-option-tabs"),FusionPageBuilderEvents.trigger("fusion-switch-element-option-tabs"),C(this).parent().addClass("current").removeClass("inactive"),C(this).parent().siblings().removeClass("current").addClass("inactive"),i=C(this).attr("href"),C(this).parents(".fusion-builder-modal-container").find(".fusion-tab-content").not(i).css("display","none"),C(".fusion-builder-layouts-tab").hide(),C(this).parents(".fusion-builder-modal-container").length?C(this).parents(".fusion-builder-modal-container").find(i).fadeIn("fast"):C(i).fadeIn("fast"),jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").length&&setTimeout(function(){jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").focus()},50)}),jQuery(".fusion_builder_modal_overlay").on("click",function(){FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),FusionPageBuilderEvents.trigger("fusion-close-modal")}),jQuery(".fusion_builder_modal_inner_row_overlay").on("click",function(){FusionPageBuilderEvents.trigger("fusion-close-inner-modal"),FusionPageBuilderEvents.trigger("fusion-hide-library")}),e=jQuery(".fusion-builder-demo-select").val(),jQuery("#fusion-builder-layouts-demos .demo-"+e).show(),jQuery(".fusion-builder-demo-select").on("change",function(){e=jQuery(".fusion-builder-demo-select").val(),jQuery("#fusion-builder-layouts-demos .fusion-page-layouts").hide(),jQuery("#fusion-builder-demo-url-invalid").hide(),jQuery(".fusion-builder-demo-page-link").val(""),jQuery("#fusion-builder-layouts-demos .demo-"+e).show()}),jQuery(".fusion-builder-demo-page-link").on("input",function(){var e,i,t,n=jQuery(this).val();"/"===(n=n.replace("https://","").replace("http://",""))[n.length-1]||_.isEmpty(n)||(n+="/"),i=(e=jQuery("#fusion-builder-layouts-demos").find('.fusion-page-layout[data-page-link="'+n+'"]')).closest(".fusion-page-layouts"),jQuery("#fusion-builder-layouts-demos .fusion-page-layouts").hide(),jQuery("#fusion-builder-demo-url-invalid").hide(),_.isEmpty(n)?(t=jQuery(".fusion-builder-demo-select").val(),jQuery("#fusion-builder-layouts-demos .demo-"+t).show()):e.length?(i.show(),i.find(".fusion-page-layout").hide(),e.show()):jQuery("#fusion-builder-demo-url-invalid").show()}),f.live("click",function(e){var i,t="fas",n=jQuery(this).find("i");e.preventDefault(),i="fa-"+jQuery(this).find("i").attr("data-name"),n.hasClass("fab")?t="fab":n.hasClass("far")?t="far":n.hasClass("fal")&&(t="fal"),C(this).hasClass("selected-element")?(C(this).find("i").parent().parent().find(".selected-element").removeClass("selected-element"),C(this).find("i").parent().parent().parent().find(".fusion-iconpicker-input").attr("value","").trigger("change")):(C(this).find("i").parent().parent().find(".selected-element").removeClass("selected-element"),C(this).find("i").parent().addClass("selected-element"),C(this).find("i").parent().parent().parent().find(".fusion-iconpicker-input").attr("value",i+" "+t).trigger("change"))}),C(document).on("click","#qt_content_fusion_shortcodes_text_mode, #qt_excerpt_fusion_shortcodes_text_mode, #qt_element_content_fusion_shortcodes_text_mode",function(){openShortcodeGenerator(C(this))}),C('input[type="radio"][name="screen_columns"]').on("click",function(){C(window).trigger("resize")}),C(".notice-dismiss, #show-settings-link").on("click",function(){setTimeout(function(){C(window).trigger("resize")},750)}),C("#new_template_name").keydown(function(e){return 13!==e.keyCode&&"13"!==e.keyCode||(e.preventDefault(),e.stopPropagation(),FusionPageBuilderEvents.trigger("fusion-save-layout"),!1)}),C("body").on("keydown","#fusion-builder-save-element-input",function(e){return 13!==e.keyCode&&"13"!==e.keyCode||(e.preventDefault(),e.stopPropagation(),C(".fusion-builder-element-button-save").trigger("click"),!1)}),jQuery(".fusion-preview").click(function(e){e.preventDefault(),jQuery("#post-preview").trigger("click")}),jQuery(".fusion-save-draft").click(function(e){e.preventDefault(),jQuery("#save-post").trigger("click")}),jQuery(".fusion-update").click(function(e){e.preventDefault(),jQuery("#publish").trigger("click")}),i=fusionBuilderConfig.fontawesomeicons,l='<div class="fusion-icons-rendered" style="height:0px; overflow:hidden;">',s={fab:"Brands",far:"Regular",fas:"Solid",fal:"Light"},r=0,u="",_.each(i,function(i,t){_.each(i[1],function(e){-1!==fusionBuilderConfig.fontawesomesubsets.indexOf(e)&&(u=500<=r?' style="display:none;"':"",l+='<span class="icon_preview icon-'+i[0]+'" title="'+t+" - "+s[e]+'" '+u+'><i class="'+i[0]+" "+e+'" data-name="'+i[0].substr(3)+'"></i></span>',r++)})}),l+="</div>",C("body").append(l)})}(jQuery),function(o){window.fusionBuilderInsertIntoEditor=function(e,i){var t,n;"tinymce"!==window.SCmoduleContentEditorMode||""!==i&&void 0!==i?("excerpt"===(t=o(null===i||""===i||void 0===i?window.editorArea:"#"+i)).attr("id")&&(FusionPageBuilderApp.fromExcerpt=!0),void 0===window.cursorPosition?0===t.getCursorPosition()?t.val(e+t.val()):t.val().length===t.getCursorPosition()?t.val(t.val()+e):t.val(t.val().slice(0,t.getCursorPosition())+e+t.val().slice(t.getCursorPosition())):t.val([t.val().slice(0,window.cursorPosition),e,t.val().slice(window.cursorPosition)].join(""))):void 0!==window.tinyMCE&&((n=FusionPageBuilderApp.shortcodeGeneratorActiveEditor).focus(),"excerpt"===n.id&&(FusionPageBuilderApp.fromExcerpt=!0),window.tinyMCE.activeEditor.execCommand("mceInsertContent",!1,e),window.tinyMCE.activeEditor.execCommand("mceCleanup",!1)),!1===FusionPageBuilderApp.manuallyAdded&&(FusionPageBuilderApp.shortcodeGeneratorActiveEditor="")}}(jQuery),function(o){o.fn.getCursorPosition=function(){var e,i,t=o(this).get(0),n=0;return"selectionStart"in t?n=t.selectionStart:"selection"in document&&(t.focus(),e=document.selection.createRange(),i=document.selection.createRange().text.length,e.moveStart("character",-t.value.length),n=e.text.length-i),n}}(jQuery),function(n){var o={},a=new Array("[]"),t=new Array("[]"),l=0;window.tracking="on",window.fusionHistoryState="",(window.fusionHistoryManager=o).captureEditor=function(){var e;o.isTrackingOn()&&(25==l?a.shift():l+=1,1<l&&(n(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),n(".fusion-builder-history-list").prepend('<li data-state-id="'+l+'" class="history-state-'+l+' fusion-history-active-state"><span class="dashicons dashicons-arrow-right-alt2"></span>'+fusionHistoryState+"</li>")),e=fusionBuilderGetContent("content",!0),a[l]=e,t[l]=fusionHistoryState,o.updateButtons(),fusionHistoryState="")},o.turnOnTracking=function(){window.tracking="on","undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.pauseBuilder&&o.turnOffTracking()},o.turnOffTracking=function(){window.tracking="off"},o.doUndo=function(e){var i;e&&e.preventDefault(),o.hasUndo()&&(o.turnOffTracking(),"[]"!==(i=a[l-=1])&&(FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(i),n(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),n(".fusion-builder-history-list").find(".history-state-"+l).addClass("fusion-history-active-state")),o.updateButtons())},o.doRedo=function(e){var i;e&&e.preventDefault(),o.hasRedo()&&(o.turnOffTracking(),i=a[l+=1],FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(i),o.updateButtons(),n(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),n(".fusion-builder-history-list").find(".history-state-"+l).addClass("fusion-history-active-state"))},o.historyStep=function(e,i){var t;i&&i.preventDefault(),t=a[e],FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(t),l=e,o.updateButtons(),n(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),n(".fusion-builder-history-list").find(".history-state-"+l).addClass("fusion-history-active-state")},o.isTrackingOn=function(){return"on"===window.tracking},o.logStacks=function(){},o.clearEditor=function(e){var i;a=new Array("[]"),t=new Array("[]"),l=1,fusionHistoryState="","blank"===e?a[l]="":(i=fusionBuilderGetContent("content",!0),a[l]=i),o.updateButtons(),n(".fusion-builder-history-list").html('<li data-state-id="1" class="history-state-1 fusion-history-active-state"><span class="dashicons dashicons-arrow-right-alt2"></span>'+fusionBuilderText.empty+"</li>")},o.hasUndo=function(){return 1!==l},o.hasRedo=function(){return l<a.length-1},o.getCommands=function(){return a},o.updateButtons=function(){o.hasUndo()?(n(".fusion-builder-layout-buttons-undo").addClass("fusion-history-has-step"),n(".fusion-builder-layout-buttons-history").addClass("fusion-history-has-step")):(n(".fusion-builder-layout-buttons-undo").removeClass("fusion-history-has-step"),n(".fusion-builder-layout-buttons-history").removeClass("fusion-history-has-step")),o.hasRedo()?n(".fusion-builder-layout-buttons-redo").addClass("fusion-history-has-step"):n(".fusion-builder-layout-buttons-redo").removeClass("fusion-history-has-step")}}(jQuery);